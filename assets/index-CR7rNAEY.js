(function(){const relList=document.createElement("link").relList;if(relList&&relList.supports&&relList.supports("modulepreload"))return;for(const link of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(link);new MutationObserver(mutations=>{for(const mutation of mutations)if(mutation.type==="childList")for(const node of mutation.addedNodes)node.tagName==="LINK"&&node.rel==="modulepreload"&&processPreload(node)}).observe(document,{childList:!0,subtree:!0});function getFetchOpts(link){const fetchOpts={};return link.integrity&&(fetchOpts.integrity=link.integrity),link.referrerPolicy&&(fetchOpts.referrerPolicy=link.referrerPolicy),link.crossOrigin==="use-credentials"?fetchOpts.credentials="include":link.crossOrigin==="anonymous"?fetchOpts.credentials="omit":fetchOpts.credentials="same-origin",fetchOpts}function processPreload(link){if(link.ep)return;link.ep=!0;const fetchOpts=getFetchOpts(link);fetch(link.href,fetchOpts)}})();(function(){var eventHandlers={},locationHash="";try{locationHash=location.hash.toString()}catch{}var initParams=urlParseHashParams(locationHash),storedParams=sessionStorageGet("initParams");if(storedParams)for(var key in storedParams)typeof initParams[key]>"u"&&(initParams[key]=storedParams[key]);sessionStorageSet("initParams",initParams);var isIframe=!1,iFrameStyle;try{if(isIframe=window.parent!=null&&window!=window.parent,isIframe){window.addEventListener("message",function(event){if(event.source===window.parent){try{var dataParsed=JSON.parse(event.data)}catch{return}if(!(!dataParsed||!dataParsed.eventType))if(dataParsed.eventType=="set_custom_style")event.origin==="https://web.telegram.org"&&(iFrameStyle.innerHTML=dataParsed.eventData);else if(dataParsed.eventType=="reload_iframe"){try{window.parent.postMessage(JSON.stringify({eventType:"iframe_will_reload"}),"*")}catch{}location.reload()}else receiveEvent(dataParsed.eventType,dataParsed.eventData)}}),iFrameStyle=document.createElement("style"),document.head.appendChild(iFrameStyle);try{window.parent.postMessage(JSON.stringify({eventType:"iframe_ready",eventData:{reload_supported:!0}}),"*")}catch{}}}catch{}function urlSafeDecode(urlencoded){try{return urlencoded=urlencoded.replace(/\+/g,"%20"),decodeURIComponent(urlencoded)}catch{return urlencoded}}function urlParseHashParams(locationHash2){locationHash2=locationHash2.replace(/^#/,"");var params={};if(!locationHash2.length)return params;if(locationHash2.indexOf("=")<0&&locationHash2.indexOf("?")<0)return params._path=urlSafeDecode(locationHash2),params;var qIndex=locationHash2.indexOf("?");if(qIndex>=0){var pathParam=locationHash2.substr(0,qIndex);params._path=urlSafeDecode(pathParam),locationHash2=locationHash2.substr(qIndex+1)}var query_params=urlParseQueryString(locationHash2);for(var k in query_params)params[k]=query_params[k];return params}function urlParseQueryString(queryString){var params={};if(!queryString.length)return params;var queryStringParams=queryString.split("&"),i,param,paramName,paramValue;for(i=0;i<queryStringParams.length;i++)param=queryStringParams[i].split("="),paramName=urlSafeDecode(param[0]),paramValue=param[1]==null?null:urlSafeDecode(param[1]),params[paramName]=paramValue;return params}function urlAppendHashParams(url2,addHash){var ind=url2.indexOf("#");if(ind<0)return url2+"#"+addHash;var curHash=url2.substr(ind+1);return curHash.indexOf("=")>=0||curHash.indexOf("?")>=0?url2+"&"+addHash:curHash.length>0?url2+"?"+addHash:url2+addHash}function postEvent(eventType,callback,eventData){if(callback||(callback=function(){}),eventData===void 0&&(eventData=""),console.log("[Telegram.WebView] > postEvent",eventType,eventData),window.TelegramWebviewProxy!==void 0)TelegramWebviewProxy.postEvent(eventType,JSON.stringify(eventData)),callback();else if(window.external&&"notify"in window.external)window.external.notify(JSON.stringify({eventType,eventData})),callback();else if(isIframe)try{var trustedTarget="https://web.telegram.org";trustedTarget="*",window.parent.postMessage(JSON.stringify({eventType,eventData}),trustedTarget),callback()}catch(e){callback(e)}else callback({notAvailable:!0})}function receiveEvent(eventType,eventData){console.log("[Telegram.WebView] < receiveEvent",eventType,eventData),callEventCallbacks(eventType,function(callback){callback(eventType,eventData)})}function callEventCallbacks(eventType,func){var curEventHandlers=eventHandlers[eventType];if(!(curEventHandlers===void 0||!curEventHandlers.length))for(var i=0;i<curEventHandlers.length;i++)try{func(curEventHandlers[i])}catch{}}function onEvent(eventType,callback){eventHandlers[eventType]===void 0&&(eventHandlers[eventType]=[]);var index=eventHandlers[eventType].indexOf(callback);index===-1&&eventHandlers[eventType].push(callback)}function offEvent(eventType,callback){if(eventType.includes("ButtonClicked")){eventHandlers[eventType]=[];return}if(eventHandlers[eventType]!==void 0){var index=eventHandlers[eventType].indexOf(callback);index!==-1&&eventHandlers[eventType].splice(index,1)}}function sessionStorageSet(key2,value){try{return window.sessionStorage.setItem("__telegram__"+key2,JSON.stringify(value)),!0}catch{}return!1}function sessionStorageGet(key2){try{return JSON.parse(window.sessionStorage.getItem("__telegram__"+key2))}catch{}return null}window.Telegram||(window.Telegram={}),window.Telegram.WebView={initParams,isIframe,onEvent,offEvent,postEvent,receiveEvent,callEventCallbacks},window.Telegram.Utils={urlSafeDecode,urlParseQueryString,urlParseHashParams,urlAppendHashParams,sessionStorageSet,sessionStorageGet},window.TelegramGameProxy_receiveEvent=receiveEvent,window.TelegramGameProxy={receiveEvent}})();function getWebApp(){var Utils=window.Telegram.Utils,WebView=window.Telegram.WebView,initParams=WebView.initParams,isIframe=WebView.isIframe,WebApp={},webAppInitData="",webAppInitDataUnsafe={},themeParams={},colorScheme="light",webAppVersion="7.0",webAppPlatform="unknown",webAppIsActive=!0,webAppIsFullscreen=!1,webAppIsOrientationLocked=!1,webAppBackgroundColor="bg_color",webAppHeaderColorKey="bg_color",webAppHeaderColor=null;if(initParams.tgWebAppData&&initParams.tgWebAppData.length){webAppInitData=initParams.tgWebAppData,webAppInitDataUnsafe=Utils.urlParseQueryString(webAppInitData);for(var key in webAppInitDataUnsafe){var val=webAppInitDataUnsafe[key];try{(val.substr(0,1)=="{"&&val.substr(-1)=="}"||val.substr(0,1)=="["&&val.substr(-1)=="]")&&(webAppInitDataUnsafe[key]=JSON.parse(val))}catch{}}}var stored_theme_params=Utils.sessionStorageGet("themeParams");if(initParams.tgWebAppThemeParams&&initParams.tgWebAppThemeParams.length){var themeParamsRaw=initParams.tgWebAppThemeParams;try{var theme_params=JSON.parse(themeParamsRaw);theme_params&&setThemeParams(theme_params)}catch{}}stored_theme_params&&setThemeParams(stored_theme_params);var stored_def_colors=Utils.sessionStorageGet("defaultColors");if(initParams.tgWebAppDefaultColors&&initParams.tgWebAppDefaultColors.length){var defColorsRaw=initParams.tgWebAppDefaultColors;try{var def_colors=JSON.parse(defColorsRaw);def_colors&&setDefaultColors(def_colors)}catch{}}stored_def_colors&&setDefaultColors(stored_def_colors),initParams.tgWebAppVersion&&(webAppVersion=initParams.tgWebAppVersion),initParams.tgWebAppPlatform&&(webAppPlatform=initParams.tgWebAppPlatform);var stored_fullscreen=Utils.sessionStorageGet("isFullscreen");initParams.tgWebAppFullscreen&&setFullscreen(!0),stored_fullscreen&&setFullscreen(stored_fullscreen=="yes");var stored_orientation_lock=Utils.sessionStorageGet("isOrientationLocked");stored_orientation_lock&&setOrientationLock(stored_orientation_lock=="yes");function onThemeChanged(eventType,eventData){eventData.theme_params&&(setThemeParams(eventData.theme_params),window.Telegram.WebApp.MainButton.setParams({}),window.Telegram.WebApp.SecondaryButton.setParams({}),updateHeaderColor(),updateBackgroundColor(),updateBottomBarColor(),receiveWebViewEvent("themeChanged"))}var lastWindowHeight=window.innerHeight;function onViewportChanged(eventType,eventData){eventData.height&&(window.removeEventListener("resize",onWindowResize),setViewportHeight(eventData))}function onWindowResize(e){lastWindowHeight!=window.innerHeight&&(lastWindowHeight=window.innerHeight,receiveWebViewEvent("viewportChanged",{isStateStable:!0}))}function onSafeAreaChanged(eventType,eventData){eventData&&setSafeAreaInset(eventData)}function onContentSafeAreaChanged(eventType,eventData){eventData&&setContentSafeAreaInset(eventData)}function onVisibilityChanged(eventType,eventData){eventData.is_visible?(webAppIsActive=!0,receiveWebViewEvent("activated")):(webAppIsActive=!1,receiveWebViewEvent("deactivated"))}function linkHandler(e){if(!(e.metaKey||e.ctrlKey)){for(var el=e.target;el.tagName!="A"&&el.parentNode;)el=el.parentNode;el.tagName=="A"&&el.target!="_blank"&&(el.protocol=="http:"||el.protocol=="https:")&&el.hostname=="t.me"&&(WebApp.openTgLink(el.href),e.preventDefault())}}function strTrim(str){return str.toString().replace(/^\s+|\s+$/g,"")}function receiveWebViewEvent(eventType){var args=Array.prototype.slice.call(arguments);eventType=args.shift(),WebView.callEventCallbacks("webview:"+eventType,function(callback){callback.apply(WebApp,args)})}function onWebViewEvent(eventType,callback){WebView.onEvent("webview:"+eventType,callback)}function offWebViewEvent(eventType,callback){WebView.offEvent("webview:"+eventType,callback)}function setCssProperty(name,value){var root=document.documentElement;root&&root.style&&root.style.setProperty&&root.style.setProperty("--tg-"+name,value)}function setFullscreen(is_fullscreen){webAppIsFullscreen=!!is_fullscreen,Utils.sessionStorageSet("isFullscreen",webAppIsFullscreen?"yes":"no")}function setOrientationLock(is_locked){webAppIsOrientationLocked=!!is_locked,Utils.sessionStorageSet("isOrientationLocked",webAppIsOrientationLocked?"yes":"no")}function setThemeParams(theme_params2){theme_params2.bg_color=="#1c1c1d"&&theme_params2.bg_color==theme_params2.secondary_bg_color&&(theme_params2.secondary_bg_color="#2c2c2e");var color;for(var key2 in theme_params2)(color=parseColorToHex(theme_params2[key2]))&&(themeParams[key2]=color,key2=="bg_color"&&(colorScheme=isColorDark(color)?"dark":"light",setCssProperty("color-scheme",colorScheme)),key2="theme-"+key2.split("_").join("-"),setCssProperty(key2,color));Utils.sessionStorageSet("themeParams",themeParams)}function setDefaultColors(def_colors2){colorScheme=="dark"?(def_colors2.bg_dark_color&&(webAppBackgroundColor=def_colors2.bg_dark_color),def_colors2.header_dark_color&&(webAppHeaderColorKey=null,webAppHeaderColor=def_colors2.header_dark_color)):(def_colors2.bg_color&&(webAppBackgroundColor=def_colors2.bg_color),def_colors2.header_color&&(webAppHeaderColorKey=null,webAppHeaderColor=def_colors2.header_color)),Utils.sessionStorageSet("defaultColors",def_colors2)}var webAppCallbacks={};function generateCallbackId(len){for(var tries=100;--tries;){for(var id="",chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",chars_len=chars.length,i=0;i<len;i++)id+=chars[Math.floor(Math.random()*chars_len)];if(!webAppCallbacks[id])return webAppCallbacks[id]={},id}throw Error("WebAppCallbackIdGenerateFailed")}var viewportHeight=!1,viewportStableHeight=!1,isExpanded=!0;function setViewportHeight(data){typeof data<"u"&&(isExpanded=!!data.is_expanded,viewportHeight=data.height,data.is_state_stable&&(viewportStableHeight=data.height),receiveWebViewEvent("viewportChanged",{isStateStable:!!data.is_state_stable}));var height,stable_height;viewportHeight!==!1?height=viewportHeight-bottomBarHeight+"px":height=bottomBarHeight?"calc(100vh - "+bottomBarHeight+"px)":"100vh",viewportStableHeight!==!1?stable_height=viewportStableHeight-bottomBarHeight+"px":stable_height=bottomBarHeight?"calc(100vh - "+bottomBarHeight+"px)":"100vh",setCssProperty("viewport-height",height),setCssProperty("viewport-stable-height",stable_height)}var safeAreaInset={top:0,bottom:0,left:0,right:0};function setSafeAreaInset(data){typeof data<"u"&&(typeof data.top<"u"&&(safeAreaInset.top=data.top),typeof data.bottom<"u"&&(safeAreaInset.bottom=data.bottom),typeof data.left<"u"&&(safeAreaInset.left=data.left),typeof data.right<"u"&&(safeAreaInset.right=data.right),receiveWebViewEvent("safeAreaChanged")),setCssProperty("safe-area-inset-top",safeAreaInset.top+"px"),setCssProperty("safe-area-inset-bottom",safeAreaInset.bottom+"px"),setCssProperty("safe-area-inset-left",safeAreaInset.left+"px"),setCssProperty("safe-area-inset-right",safeAreaInset.right+"px")}var contentSafeAreaInset={top:0,bottom:0,left:0,right:0};function setContentSafeAreaInset(data){typeof data<"u"&&(typeof data.top<"u"&&(contentSafeAreaInset.top=data.top),typeof data.bottom<"u"&&(contentSafeAreaInset.bottom=data.bottom),typeof data.left<"u"&&(contentSafeAreaInset.left=data.left),typeof data.right<"u"&&(contentSafeAreaInset.right=data.right),receiveWebViewEvent("contentSafeAreaChanged")),setCssProperty("content-safe-area-inset-top",contentSafeAreaInset.top+"px"),setCssProperty("content-safe-area-inset-bottom",contentSafeAreaInset.bottom+"px"),setCssProperty("content-safe-area-inset-left",contentSafeAreaInset.left+"px"),setCssProperty("content-safe-area-inset-right",contentSafeAreaInset.right+"px")}var isClosingConfirmationEnabled=!1;function setClosingConfirmation(need_confirmation){if(!versionAtLeast("6.2")){console.warn("[Telegram.WebApp] Closing confirmation is not supported in version "+webAppVersion);return}isClosingConfirmationEnabled=!!need_confirmation,WebView.postEvent("web_app_setup_closing_behavior",!1,{need_confirmation:isClosingConfirmationEnabled})}var isVerticalSwipesEnabled=!0;function toggleVerticalSwipes(enable_swipes){if(!versionAtLeast("7.7")){console.warn("[Telegram.WebApp] Changing swipes behavior is not supported in version "+webAppVersion);return}isVerticalSwipesEnabled=!!enable_swipes,WebView.postEvent("web_app_setup_swipe_behavior",!1,{allow_vertical_swipe:isVerticalSwipesEnabled})}function onFullscreenChanged(eventType,eventData){setFullscreen(eventData.is_fullscreen),receiveWebViewEvent("fullscreenChanged")}function onFullscreenFailed(eventType,eventData){eventData.error=="ALREADY_FULLSCREEN"&&!webAppIsFullscreen&&setFullscreen(!0),receiveWebViewEvent("fullscreenFailed",{error:eventData.error})}function toggleOrientationLock(locked){if(!versionAtLeast("8.0")){console.warn("[Telegram.WebApp] Orientation locking is not supported in version "+webAppVersion);return}setOrientationLock(locked),WebView.postEvent("web_app_toggle_orientation_lock",!1,{locked:webAppIsOrientationLocked})}var homeScreenCallbacks=[];function onHomeScreenAdded(eventType,eventData){receiveWebViewEvent("homeScreenAdded")}function onHomeScreenChecked(eventType,eventData){var status=eventData.status||"unknown";if(homeScreenCallbacks.length>0){for(var i=0;i<homeScreenCallbacks.length;i++){var callback=homeScreenCallbacks[i];callback(status)}homeScreenCallbacks=[]}receiveWebViewEvent("homeScreenChecked",{status})}var WebAppShareMessageOpened=!1;function onPreparedMessageSent(eventType,eventData){if(WebAppShareMessageOpened){var requestData=WebAppShareMessageOpened;WebAppShareMessageOpened=!1,requestData.callback&&requestData.callback(!0),receiveWebViewEvent("shareMessageSent")}}function onPreparedMessageFailed(eventType,eventData){if(WebAppShareMessageOpened){var requestData=WebAppShareMessageOpened;WebAppShareMessageOpened=!1,requestData.callback&&requestData.callback(!1),receiveWebViewEvent("shareMessageFailed",{error:eventData.error})}}var WebAppEmojiStatusRequested=!1;function onEmojiStatusSet(eventType,eventData){if(WebAppEmojiStatusRequested){var requestData=WebAppEmojiStatusRequested;WebAppEmojiStatusRequested=!1,requestData.callback&&requestData.callback(!0),receiveWebViewEvent("emojiStatusSet")}}function onEmojiStatusFailed(eventType,eventData){if(WebAppEmojiStatusRequested){var requestData=WebAppEmojiStatusRequested;WebAppEmojiStatusRequested=!1,requestData.callback&&requestData.callback(!1),receiveWebViewEvent("emojiStatusFailed",{error:eventData.error})}}var WebAppEmojiStatusAccessRequested=!1;function onEmojiStatusAccessRequested(eventType,eventData){if(WebAppEmojiStatusAccessRequested){var requestData=WebAppEmojiStatusAccessRequested;WebAppEmojiStatusAccessRequested=!1,requestData.callback&&requestData.callback(eventData.status=="allowed"),receiveWebViewEvent("emojiStatusAccessRequested",{status:eventData.status})}}var webAppPopupOpened=!1;function getHeaderColor(){return webAppHeaderColorKey=="secondary_bg_color"?themeParams.secondary_bg_color:webAppHeaderColorKey=="bg_color"?themeParams.bg_color:webAppHeaderColor}function setHeaderColor(color){if(!versionAtLeast("6.1")){console.warn("[Telegram.WebApp] Header color is not supported in version "+webAppVersion);return}versionAtLeast("6.9")||(themeParams.bg_color&&themeParams.bg_color==color?color="bg_color":themeParams.secondary_bg_color&&themeParams.secondary_bg_color==color&&(color="secondary_bg_color"));var head_color=null,color_key=null;if(color=="bg_color"||color=="secondary_bg_color")color_key=color;else if(versionAtLeast("6.9")&&(head_color=parseColorToHex(color),!head_color))throw console.error("[Telegram.WebApp] Header color format is invalid",color),Error("WebAppHeaderColorInvalid");if(!versionAtLeast("6.9")&&color_key!="bg_color"&&color_key!="secondary_bg_color")throw console.error("[Telegram.WebApp] Header color key should be one of Telegram.WebApp.themeParams.bg_color, Telegram.WebApp.themeParams.secondary_bg_color, 'bg_color', 'secondary_bg_color'",color),Error("WebAppHeaderColorKeyInvalid");webAppHeaderColorKey=color_key,webAppHeaderColor=head_color,updateHeaderColor()}var appHeaderColorKey=null,appHeaderColor=null;function updateHeaderColor(){(appHeaderColorKey!=webAppHeaderColorKey||appHeaderColor!=webAppHeaderColor)&&(appHeaderColorKey=webAppHeaderColorKey,appHeaderColor=webAppHeaderColor,appHeaderColor?WebView.postEvent("web_app_set_header_color",!1,{color:webAppHeaderColor}):WebView.postEvent("web_app_set_header_color",!1,{color_key:webAppHeaderColorKey}))}function getBackgroundColor(){return webAppBackgroundColor=="secondary_bg_color"?themeParams.secondary_bg_color:webAppBackgroundColor=="bg_color"?themeParams.bg_color:webAppBackgroundColor}function setBackgroundColor(color){if(!versionAtLeast("6.1")){console.warn("[Telegram.WebApp] Background color is not supported in version "+webAppVersion);return}var bg_color;if(color=="bg_color"||color=="secondary_bg_color")bg_color=color;else if(bg_color=parseColorToHex(color),!bg_color)throw console.error("[Telegram.WebApp] Background color format is invalid",color),Error("WebAppBackgroundColorInvalid");webAppBackgroundColor=bg_color,updateBackgroundColor()}var appBackgroundColor=null;function updateBackgroundColor(){var color=getBackgroundColor();appBackgroundColor!=color&&(appBackgroundColor=color,WebView.postEvent("web_app_set_background_color",!1,{color}))}var bottomBarColor="bottom_bar_bg_color";function getBottomBarColor(){return bottomBarColor=="bottom_bar_bg_color"?themeParams.bottom_bar_bg_color||themeParams.secondary_bg_color||"#ffffff":bottomBarColor=="secondary_bg_color"?themeParams.secondary_bg_color:bottomBarColor=="bg_color"?themeParams.bg_color:bottomBarColor}function setBottomBarColor(color){if(!versionAtLeast("7.10")){console.warn("[Telegram.WebApp] Bottom bar color is not supported in version "+webAppVersion);return}var bg_color;if(color=="bg_color"||color=="secondary_bg_color"||color=="bottom_bar_bg_color")bg_color=color;else if(bg_color=parseColorToHex(color),!bg_color)throw console.error("[Telegram.WebApp] Bottom bar color format is invalid",color),Error("WebAppBottomBarColorInvalid");bottomBarColor=bg_color,updateBottomBarColor(),window.Telegram.WebApp.SecondaryButton.setParams({})}var appBottomBarColor=null;function updateBottomBarColor(){var color=getBottomBarColor();appBottomBarColor!=color&&(appBottomBarColor=color,WebView.postEvent("web_app_set_bottom_bar_color",!1,{color})),initParams.tgWebAppDebug&&updateDebugBottomBar()}function parseColorToHex(color){color+="";var match;if(match=/^\s*#([0-9a-f]{6})\s*$/i.exec(color))return"#"+match[1].toLowerCase();if(match=/^\s*#([0-9a-f])([0-9a-f])([0-9a-f])\s*$/i.exec(color))return("#"+match[1]+match[1]+match[2]+match[2]+match[3]+match[3]).toLowerCase();if(match=/^\s*rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+\.{0,1}\d*))?\)\s*$/.exec(color)){var r=parseInt(match[1]),g=parseInt(match[2]),b=parseInt(match[3]);return r=(r<16?"0":"")+r.toString(16),g=(g<16?"0":"")+g.toString(16),b=(b<16?"0":"")+b.toString(16),"#"+r+g+b}return!1}function isColorDark(rgb){rgb=rgb.replace(/[\s#]/g,""),rgb.length==3&&(rgb=rgb[0]+rgb[0]+rgb[1]+rgb[1]+rgb[2]+rgb[2]);var r=parseInt(rgb.substr(0,2),16),g=parseInt(rgb.substr(2,2),16),b=parseInt(rgb.substr(4,2),16),hsp=Math.sqrt(.299*(r*r)+.587*(g*g)+.114*(b*b));return hsp<120}function versionCompare(v1,v2){typeof v1!="string"&&(v1=""),typeof v2!="string"&&(v2=""),v1=v1.replace(/^\s+|\s+$/g,"").split("."),v2=v2.replace(/^\s+|\s+$/g,"").split(".");var a=Math.max(v1.length,v2.length),i,p1,p2;for(i=0;i<a;i++)if(p1=parseInt(v1[i])||0,p2=parseInt(v2[i])||0,p1!=p2)return p1>p2?1:-1;return 0}function versionAtLeast(ver){return versionCompare(webAppVersion,ver)>=0}function byteLength(str){if(window.Blob)try{return new Blob([str]).size}catch{}for(var s=str.length,i=str.length-1;i>=0;i--){var code=str.charCodeAt(i);code>127&&code<=2047?s++:code>2047&&code<=65535&&(s+=2),code>=56320&&code<=57343&&i--}return s}var BackButton=function(){var isVisible=!1,backButton={};Object.defineProperty(backButton,"isVisible",{set:function(val2){setParams({is_visible:val2})},get:function(){return isVisible},enumerable:!0});var curButtonState=null;WebView.onEvent("back_button_pressed",onBackButtonPressed);function onBackButtonPressed(){receiveWebViewEvent("backButtonClicked")}function buttonParams(){return{is_visible:isVisible}}function buttonState(btn_params){return typeof btn_params>"u"&&(btn_params=buttonParams()),JSON.stringify(btn_params)}function buttonCheckVersion(){return versionAtLeast("6.1")?!0:(console.warn("[Telegram.WebApp] BackButton is not supported in version "+webAppVersion),!1)}function updateButton(){var btn_params=buttonParams(),btn_state=buttonState(btn_params);curButtonState!==btn_state&&(curButtonState=btn_state,WebView.postEvent("web_app_setup_back_button",!1,btn_params))}function setParams(params){return buttonCheckVersion()&&(typeof params.is_visible<"u"&&(isVisible=!!params.is_visible),updateButton()),backButton}return backButton.onClick=function(callback){return buttonCheckVersion()&&onWebViewEvent("backButtonClicked",callback),backButton},backButton.offClick=function(callback){return buttonCheckVersion()&&offWebViewEvent("backButtonClicked",callback),backButton},backButton.show=function(){return setParams({is_visible:!0})},backButton.hide=function(){return setParams({is_visible:!1})},backButton}(),debugBottomBar=null,debugBottomBarBtns={},bottomBarHeight=0;if(initParams.tgWebAppDebug){debugBottomBar=document.createElement("tg-bottom-bar");var debugBottomBarStyle={display:"flex",gap:"7px",font:"600 14px/18px sans-serif",width:"100%",background:getBottomBarColor(),position:"fixed",left:"0",right:"0",bottom:"0",margin:"0",padding:"7px",textAlign:"center",boxSizing:"border-box",zIndex:"10000"};for(var k in debugBottomBarStyle)debugBottomBar.style[k]=debugBottomBarStyle[k];document.addEventListener("DOMContentLoaded",function onDomLoaded(event){document.removeEventListener("DOMContentLoaded",onDomLoaded),document.body.appendChild(debugBottomBar)});var animStyle=document.createElement("style");animStyle.innerHTML='tg-bottom-button.shine { position: relative; overflow: hidden; } tg-bottom-button.shine:before { content:""; position: absolute; top: 0; width: 100%; height: 100%; background: linear-gradient(120deg, transparent, rgba(255, 255, 255, .2), transparent); animation: tg-bottom-button-shine 5s ease-in-out infinite; } @-webkit-keyframes tg-bottom-button-shine { 0% {left: -100%;} 12%,100% {left: 100%}} @keyframes tg-bottom-button-shine { 0% {left: -100%;} 12%,100% {left: 100%}}',debugBottomBar.appendChild(animStyle)}function updateDebugBottomBar(){var mainBtn=debugBottomBarBtns.main._bottomButton,secondaryBtn=debugBottomBarBtns.secondary._bottomButton;mainBtn.isVisible||secondaryBtn.isVisible?(debugBottomBar.style.display="flex",bottomBarHeight=58,mainBtn.isVisible&&secondaryBtn.isVisible&&(secondaryBtn.position=="top"?(debugBottomBar.style.flexDirection="column-reverse",bottomBarHeight+=51):secondaryBtn.position=="bottom"?(debugBottomBar.style.flexDirection="column",bottomBarHeight+=51):secondaryBtn.position=="left"?debugBottomBar.style.flexDirection="row-reverse":secondaryBtn.position=="right"&&(debugBottomBar.style.flexDirection="row"))):(debugBottomBar.style.display="none",bottomBarHeight=0),debugBottomBar.style.background=getBottomBarColor(),document.documentElement&&(document.documentElement.style.boxSizing="border-box",document.documentElement.style.paddingBottom=bottomBarHeight+"px"),setViewportHeight()}var BottomButtonConstructor=function(type){var isMainButton=type=="main";if(isMainButton)var setupFnName="web_app_setup_main_button",tgEventName="main_button_pressed",webViewEventName="mainButtonClicked",buttonTextDefault="Continue",buttonColorDefault=function(){return themeParams.button_color||"#2481cc"},buttonTextColorDefault=function(){return themeParams.button_text_color||"#ffffff"};else var setupFnName="web_app_setup_secondary_button",tgEventName="secondary_button_pressed",webViewEventName="secondaryButtonClicked",buttonTextDefault="Cancel",buttonColorDefault=function(){return getBottomBarColor()},buttonTextColorDefault=function(){return themeParams.button_color||"#2481cc"};var isVisible=!1,isActive=!0,hasShineEffect=!1,isProgressVisible=!1,buttonType=type,buttonText=buttonTextDefault,buttonColor=!1,buttonTextColor=!1,buttonPosition="left",bottomButton={};Object.defineProperty(bottomButton,"type",{get:function(){return buttonType},enumerable:!0}),Object.defineProperty(bottomButton,"text",{set:function(val2){bottomButton.setParams({text:val2})},get:function(){return buttonText},enumerable:!0}),Object.defineProperty(bottomButton,"color",{set:function(val2){bottomButton.setParams({color:val2})},get:function(){return buttonColor||buttonColorDefault()},enumerable:!0}),Object.defineProperty(bottomButton,"textColor",{set:function(val2){bottomButton.setParams({text_color:val2})},get:function(){return buttonTextColor||buttonTextColorDefault()},enumerable:!0}),Object.defineProperty(bottomButton,"isVisible",{set:function(val2){bottomButton.setParams({is_visible:val2})},get:function(){return isVisible},enumerable:!0}),Object.defineProperty(bottomButton,"isProgressVisible",{get:function(){return isProgressVisible},enumerable:!0}),Object.defineProperty(bottomButton,"isActive",{set:function(val2){bottomButton.setParams({is_active:val2})},get:function(){return isActive},enumerable:!0}),Object.defineProperty(bottomButton,"hasShineEffect",{set:function(val2){bottomButton.setParams({has_shine_effect:val2})},get:function(){return hasShineEffect},enumerable:!0}),isMainButton||Object.defineProperty(bottomButton,"position",{set:function(val2){bottomButton.setParams({position:val2})},get:function(){return buttonPosition},enumerable:!0});var curButtonState=null;WebView.onEvent(tgEventName,onBottomButtonPressed);var debugBtn=null;if(initParams.tgWebAppDebug){debugBtn=document.createElement("tg-bottom-button");var debugBtnStyle={display:"none",width:"100%",height:"44px",borderRadius:"0",background:"no-repeat right center",padding:"13px 15px",textAlign:"center",boxSizing:"border-box"};for(var k2 in debugBtnStyle)debugBtn.style[k2]=debugBtnStyle[k2];debugBottomBar.appendChild(debugBtn),debugBtn.addEventListener("click",onBottomButtonPressed,!1),debugBtn._bottomButton=bottomButton,debugBottomBarBtns[type]=debugBtn}function onBottomButtonPressed(){isActive&&receiveWebViewEvent(webViewEventName)}function buttonParams(){var color=bottomButton.color,text_color=bottomButton.textColor;if(isVisible){var params={is_visible:!0,is_active:isActive,is_progress_visible:isProgressVisible,text:buttonText,color,text_color,has_shine_effect:hasShineEffect&&isActive&&!isProgressVisible};isMainButton||(params.position=buttonPosition)}else var params={is_visible:!1};return params}function buttonState(btn_params){return typeof btn_params>"u"&&(btn_params=buttonParams()),JSON.stringify(btn_params)}function updateButton(){var btn_params=buttonParams(),btn_state=buttonState(btn_params);curButtonState!==btn_state&&(curButtonState=btn_state,WebView.postEvent(setupFnName,!1,btn_params),initParams.tgWebAppDebug&&updateDebugButton(btn_params))}function updateDebugButton(btn_params){btn_params.is_visible?(debugBtn.style.display="block",debugBtn.style.opacity=btn_params.is_active?"1":"0.8",debugBtn.style.cursor=btn_params.is_active?"pointer":"auto",debugBtn.disabled=!btn_params.is_active,debugBtn.innerText=btn_params.text,debugBtn.className=btn_params.has_shine_effect?"shine":"",debugBtn.style.backgroundImage=btn_params.is_progress_visible?"url('data:image/svg+xml,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewport="0 0 48 48" width="48px" height="48px"><circle cx="50%" cy="50%" stroke="'+btn_params.text_color+'" stroke-width="2.25" stroke-linecap="round" fill="none" stroke-dashoffset="106" r="9" stroke-dasharray="56.52" rotate="-90"><animate attributeName="stroke-dashoffset" attributeType="XML" dur="360s" from="0" to="12500" repeatCount="indefinite"></animate><animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="-90 24 24" to="630 24 24" repeatCount="indefinite"></animateTransform></circle></svg>')+"')":"none",debugBtn.style.backgroundColor=btn_params.color,debugBtn.style.color=btn_params.text_color):debugBtn.style.display="none",updateDebugBottomBar()}function setParams(params){if(typeof params.text<"u"){var text=strTrim(params.text);if(!text.length)throw console.error("[Telegram.WebApp] Bottom button text is required",params.text),Error("WebAppBottomButtonParamInvalid");if(text.length>64)throw console.error("[Telegram.WebApp] Bottom button text is too long",text),Error("WebAppBottomButtonParamInvalid");buttonText=text}if(typeof params.color<"u")if(params.color===!1||params.color===null)buttonColor=!1;else{var color=parseColorToHex(params.color);if(!color)throw console.error("[Telegram.WebApp] Bottom button color format is invalid",params.color),Error("WebAppBottomButtonParamInvalid");buttonColor=color}if(typeof params.text_color<"u")if(params.text_color===!1||params.text_color===null)buttonTextColor=!1;else{var text_color=parseColorToHex(params.text_color);if(!text_color)throw console.error("[Telegram.WebApp] Bottom button text color format is invalid",params.text_color),Error("WebAppBottomButtonParamInvalid");buttonTextColor=text_color}if(typeof params.is_visible<"u"){if(params.is_visible&&!bottomButton.text.length)throw console.error("[Telegram.WebApp] Bottom button text is required"),Error("WebAppBottomButtonParamInvalid");isVisible=!!params.is_visible}if(typeof params.has_shine_effect<"u"&&(hasShineEffect=!!params.has_shine_effect),!isMainButton&&typeof params.position<"u"){if(params.position!="left"&&params.position!="right"&&params.position!="top"&&params.position!="bottom")throw console.error("[Telegram.WebApp] Bottom button posiition is invalid",params.position),Error("WebAppBottomButtonParamInvalid");buttonPosition=params.position}return typeof params.is_active<"u"&&(isActive=!!params.is_active),updateButton(),bottomButton}return bottomButton.setText=function(text){return bottomButton.setParams({text})},bottomButton.onClick=function(callback){return onWebViewEvent(webViewEventName,callback),bottomButton},bottomButton.offClick=function(callback){return offWebViewEvent(webViewEventName,callback),bottomButton},bottomButton.show=function(){return bottomButton.setParams({is_visible:!0})},bottomButton.hide=function(){return bottomButton.setParams({is_visible:!1})},bottomButton.enable=function(){return bottomButton.setParams({is_active:!0})},bottomButton.disable=function(){return bottomButton.setParams({is_active:!1})},bottomButton.showProgress=function(leaveActive){return isActive=!!leaveActive,isProgressVisible=!0,updateButton(),bottomButton},bottomButton.hideProgress=function(){return bottomButton.isActive||(isActive=!0),isProgressVisible=!1,updateButton(),bottomButton},bottomButton.setParams=setParams,bottomButton},MainButton=BottomButtonConstructor("main"),SecondaryButton=BottomButtonConstructor("secondary"),SettingsButton=function(){var isVisible=!1,settingsButton={};Object.defineProperty(settingsButton,"isVisible",{set:function(val2){setParams({is_visible:val2})},get:function(){return isVisible},enumerable:!0});var curButtonState=null;WebView.onEvent("settings_button_pressed",onSettingsButtonPressed);function onSettingsButtonPressed(){receiveWebViewEvent("settingsButtonClicked")}function buttonParams(){return{is_visible:isVisible}}function buttonState(btn_params){return typeof btn_params>"u"&&(btn_params=buttonParams()),JSON.stringify(btn_params)}function buttonCheckVersion(){return versionAtLeast("6.10")?!0:(console.warn("[Telegram.WebApp] SettingsButton is not supported in version "+webAppVersion),!1)}function updateButton(){var btn_params=buttonParams(),btn_state=buttonState(btn_params);curButtonState!==btn_state&&(curButtonState=btn_state,WebView.postEvent("web_app_setup_settings_button",!1,btn_params))}function setParams(params){return buttonCheckVersion()&&(typeof params.is_visible<"u"&&(isVisible=!!params.is_visible),updateButton()),settingsButton}return settingsButton.onClick=function(callback){return buttonCheckVersion()&&onWebViewEvent("settingsButtonClicked",callback),settingsButton},settingsButton.offClick=function(callback){return buttonCheckVersion()&&offWebViewEvent("settingsButtonClicked",callback),settingsButton},settingsButton.show=function(){return setParams({is_visible:!0})},settingsButton.hide=function(){return setParams({is_visible:!1})},settingsButton}(),HapticFeedback=function(){var hapticFeedback={};function triggerFeedback(params){if(!versionAtLeast("6.1"))return console.warn("[Telegram.WebApp] HapticFeedback is not supported in version "+webAppVersion),hapticFeedback;if(params.type=="impact"){if(params.impact_style!="light"&&params.impact_style!="medium"&&params.impact_style!="heavy"&&params.impact_style!="rigid"&&params.impact_style!="soft")throw console.error("[Telegram.WebApp] Haptic impact style is invalid",params.impact_style),Error("WebAppHapticImpactStyleInvalid")}else if(params.type=="notification"){if(params.notification_type!="error"&&params.notification_type!="success"&&params.notification_type!="warning")throw console.error("[Telegram.WebApp] Haptic notification type is invalid",params.notification_type),Error("WebAppHapticNotificationTypeInvalid")}else if(params.type!="selection_change")throw console.error("[Telegram.WebApp] Haptic feedback type is invalid",params.type),Error("WebAppHapticFeedbackTypeInvalid");return WebView.postEvent("web_app_trigger_haptic_feedback",!1,params),hapticFeedback}return hapticFeedback.impactOccurred=function(style){return triggerFeedback({type:"impact",impact_style:style})},hapticFeedback.notificationOccurred=function(type){return triggerFeedback({type:"notification",notification_type:type})},hapticFeedback.selectionChanged=function(){return triggerFeedback({type:"selection_change"})},hapticFeedback}(),CloudStorage=function(){var cloudStorage={};function invokeStorageMethod(method,params,callback){if(!versionAtLeast("6.9"))throw console.error("[Telegram.WebApp] CloudStorage is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");return invokeCustomMethod(method,params,callback),cloudStorage}return cloudStorage.setItem=function(key2,value,callback){return invokeStorageMethod("saveStorageValue",{key:key2,value},callback)},cloudStorage.getItem=function(key2,callback){return cloudStorage.getItems([key2],callback?function(err,res){err?callback(err):callback(null,res[key2])}:null)},cloudStorage.getItems=function(keys,callback){return invokeStorageMethod("getStorageValues",{keys},callback)},cloudStorage.removeItem=function(key2,callback){return cloudStorage.removeItems([key2],callback)},cloudStorage.removeItems=function(keys,callback){return invokeStorageMethod("deleteStorageValues",{keys},callback)},cloudStorage.getKeys=function(callback){return invokeStorageMethod("getStorageKeys",{},callback)},cloudStorage}(),DeviceStorage=function(){var deviceStorage={};WebView.onEvent("device_storage_key_saved",onDeviceStorageEvent),WebView.onEvent("device_storage_key_received",onDeviceStorageEvent),WebView.onEvent("device_storage_cleared",onDeviceStorageEvent),WebView.onEvent("device_storage_failed",onDeviceStorageEvent);function onDeviceStorageEvent(eventType,eventData){if(eventData.req_id&&webAppCallbacks[eventData.req_id]){var requestData=webAppCallbacks[eventData.req_id];delete webAppCallbacks[eventData.req_id];var res=null,err=null;eventType=="device_storage_failed"?err=eventData.error||"UNKNOWN_ERROR":eventType=="device_storage_key_received"?res=eventData.value:res=!0,requestData.callback&&requestData.callback(err,res)}}function invokeStorageMethod(method,params,callback){if(!versionAtLeast("9.0"))throw console.error("[Telegram.WebApp] DeviceStorage is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");var req_id=generateCallbackId(16),req_params={req_id};for(var k2 in params)req_params[k2]=params[k2];return webAppCallbacks[req_id]={callback},WebView.postEvent(method,!1,req_params),deviceStorage}return deviceStorage.setItem=function(key2,value,callback){return invokeStorageMethod("web_app_device_storage_save_key",{key:key2,value},callback)},deviceStorage.getItem=function(key2,callback){return invokeStorageMethod("web_app_device_storage_get_key",{key:key2},callback)},deviceStorage.removeItem=function(key2,callback){return invokeStorageMethod("web_app_device_storage_save_key",{key:key2,value:null},callback)},deviceStorage.clear=function(callback){return invokeStorageMethod("web_app_device_storage_clear",{},callback)},deviceStorage}(),SecureStorage=function(){var secureStorage={};WebView.onEvent("secure_storage_key_saved",onSecureStorageEvent),WebView.onEvent("secure_storage_key_received",onSecureStorageEvent),WebView.onEvent("secure_storage_key_restored",onSecureStorageEvent),WebView.onEvent("secure_storage_cleared",onSecureStorageEvent),WebView.onEvent("secure_storage_failed",onSecureStorageEvent);function onSecureStorageEvent(eventType,eventData){if(eventData.req_id&&webAppCallbacks[eventData.req_id]){var requestData=webAppCallbacks[eventData.req_id];delete webAppCallbacks[eventData.req_id];var res=null,err=null,can_restore=null;eventType=="secure_storage_failed"?err=eventData.error||"UNKNOWN_ERROR":eventType=="secure_storage_key_received"?(res=eventData.value,eventData.can_restore&&(can_restore=!0)):eventType=="secure_storage_key_restored"?res=eventData.value:res=!0,requestData.callback&&requestData.callback(err,res,can_restore)}}function invokeStorageMethod(method,params,callback){if(!versionAtLeast("9.0"))throw console.error("[Telegram.WebApp] SecureStorage is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");var req_id=generateCallbackId(16),req_params={req_id};for(var k2 in params)req_params[k2]=params[k2];return webAppCallbacks[req_id]={callback},WebView.postEvent(method,!1,req_params),secureStorage}return secureStorage.setItem=function(key2,value,callback){return invokeStorageMethod("web_app_secure_storage_save_key",{key:key2,value},callback)},secureStorage.getItem=function(key2,callback){return invokeStorageMethod("web_app_secure_storage_get_key",{key:key2},callback)},secureStorage.restoreItem=function(key2,callback){return invokeStorageMethod("web_app_secure_storage_restore_key",{key:key2},callback)},secureStorage.removeItem=function(key2,callback){return invokeStorageMethod("web_app_secure_storage_save_key",{key:key2,value:null},callback)},secureStorage.clear=function(callback){return invokeStorageMethod("web_app_secure_storage_clear",{},callback)},secureStorage}(),BiometricManager=function(){var isInited=!1,isBiometricAvailable=!1,biometricType="unknown",isAccessRequested=!1,isAccessGranted=!1,isBiometricTokenSaved=!1,deviceId="",biometricManager={};Object.defineProperty(biometricManager,"isInited",{get:function(){return isInited},enumerable:!0}),Object.defineProperty(biometricManager,"isBiometricAvailable",{get:function(){return isInited&&isBiometricAvailable},enumerable:!0}),Object.defineProperty(biometricManager,"biometricType",{get:function(){return biometricType||"unknown"},enumerable:!0}),Object.defineProperty(biometricManager,"isAccessRequested",{get:function(){return isAccessRequested},enumerable:!0}),Object.defineProperty(biometricManager,"isAccessGranted",{get:function(){return isAccessRequested&&isAccessGranted},enumerable:!0}),Object.defineProperty(biometricManager,"isBiometricTokenSaved",{get:function(){return isBiometricTokenSaved},enumerable:!0}),Object.defineProperty(biometricManager,"deviceId",{get:function(){return deviceId||""},enumerable:!0});var initRequestState={callbacks:[]},accessRequestState=!1,authRequestState=!1,tokenRequestState=!1;WebView.onEvent("biometry_info_received",onBiometryInfoReceived),WebView.onEvent("biometry_auth_requested",onBiometryAuthRequested),WebView.onEvent("biometry_token_updated",onBiometryTokenUpdated);function onBiometryInfoReceived(eventType,eventData){if(isInited=!0,eventData.available?(isBiometricAvailable=!0,biometricType=eventData.type||"unknown",eventData.access_requested?(isAccessRequested=!0,isAccessGranted=!!eventData.access_granted,isBiometricTokenSaved=!!eventData.token_saved):(isAccessRequested=!1,isAccessGranted=!1,isBiometricTokenSaved=!1)):(isBiometricAvailable=!1,biometricType="unknown",isAccessRequested=!1,isAccessGranted=!1,isBiometricTokenSaved=!1),deviceId=eventData.device_id||"",initRequestState.callbacks.length>0){for(var i=0;i<initRequestState.callbacks.length;i++){var callback=initRequestState.callbacks[i];callback()}initRequestState.callbacks=[]}if(accessRequestState){var state=accessRequestState;accessRequestState=!1,state.callback&&state.callback(isAccessGranted)}receiveWebViewEvent("biometricManagerUpdated")}function onBiometryAuthRequested(eventType,eventData){var isAuthenticated=eventData.status=="authorized",biometricToken=eventData.token||"";if(authRequestState){var state=authRequestState;authRequestState=!1,state.callback&&state.callback(isAuthenticated,isAuthenticated?biometricToken:null)}receiveWebViewEvent("biometricAuthRequested",isAuthenticated?{isAuthenticated:!0,biometricToken}:{isAuthenticated:!1})}function onBiometryTokenUpdated(eventType,eventData){var applied=!1;if(isBiometricAvailable&&isAccessRequested&&(eventData.status=="updated"?(isBiometricTokenSaved=!0,applied=!0):eventData.status=="removed"&&(isBiometricTokenSaved=!1,applied=!0)),tokenRequestState){var state=tokenRequestState;tokenRequestState=!1,state.callback&&state.callback(applied)}receiveWebViewEvent("biometricTokenUpdated",{isUpdated:applied})}function checkVersion(){return versionAtLeast("7.2")?!0:(console.warn("[Telegram.WebApp] BiometricManager is not supported in version "+webAppVersion),!1)}function checkInit(){if(!isInited)throw console.error("[Telegram.WebApp] BiometricManager should be inited before using."),Error("WebAppBiometricManagerNotInited");return!0}return biometricManager.init=function(callback){return!checkVersion()||isInited||(callback&&initRequestState.callbacks.push(callback),WebView.postEvent("web_app_biometry_get_info",!1)),biometricManager},biometricManager.requestAccess=function(params,callback){if(!checkVersion())return biometricManager;if(checkInit(),!isBiometricAvailable)throw console.error("[Telegram.WebApp] Biometrics is not available on this device."),Error("WebAppBiometricManagerBiometricsNotAvailable");if(accessRequestState)throw console.error("[Telegram.WebApp] Access is already requested"),Error("WebAppBiometricManagerAccessRequested");var popup_params={};if(typeof params.reason<"u"){var reason=strTrim(params.reason);if(reason.length>128)throw console.error("[Telegram.WebApp] Biometric reason is too long",reason),Error("WebAppBiometricRequestAccessParamInvalid");reason.length>0&&(popup_params.reason=reason)}return accessRequestState={callback},WebView.postEvent("web_app_biometry_request_access",!1,popup_params),biometricManager},biometricManager.authenticate=function(params,callback){if(!checkVersion())return biometricManager;if(checkInit(),!isBiometricAvailable)throw console.error("[Telegram.WebApp] Biometrics is not available on this device."),Error("WebAppBiometricManagerBiometricsNotAvailable");if(!isAccessGranted)throw console.error("[Telegram.WebApp] Biometric access was not granted by the user."),Error("WebAppBiometricManagerBiometricAccessNotGranted");if(authRequestState)throw console.error("[Telegram.WebApp] Authentication request is already in progress."),Error("WebAppBiometricManagerAuthenticationRequested");var popup_params={};if(typeof params.reason<"u"){var reason=strTrim(params.reason);if(reason.length>128)throw console.error("[Telegram.WebApp] Biometric reason is too long",reason),Error("WebAppBiometricRequestAccessParamInvalid");reason.length>0&&(popup_params.reason=reason)}return authRequestState={callback},WebView.postEvent("web_app_biometry_request_auth",!1,popup_params),biometricManager},biometricManager.updateBiometricToken=function(token,callback){if(!checkVersion())return biometricManager;if(token=token||"",token.length>1024)throw console.error("[Telegram.WebApp] Token is too long",token),Error("WebAppBiometricManagerTokenInvalid");if(checkInit(),!isBiometricAvailable)throw console.error("[Telegram.WebApp] Biometrics is not available on this device."),Error("WebAppBiometricManagerBiometricsNotAvailable");if(!isAccessGranted)throw console.error("[Telegram.WebApp] Biometric access was not granted by the user."),Error("WebAppBiometricManagerBiometricAccessNotGranted");if(tokenRequestState)throw console.error("[Telegram.WebApp] Token request is already in progress."),Error("WebAppBiometricManagerTokenUpdateRequested");return tokenRequestState={callback},WebView.postEvent("web_app_biometry_update_token",!1,{token}),biometricManager},biometricManager.openSettings=function(){if(!checkVersion())return biometricManager;if(checkInit(),!isBiometricAvailable)throw console.error("[Telegram.WebApp] Biometrics is not available on this device."),Error("WebAppBiometricManagerBiometricsNotAvailable");if(!isAccessRequested)throw console.error("[Telegram.WebApp] Biometric access was not requested yet."),Error("WebAppBiometricManagerBiometricsAccessNotRequested");return isAccessGranted?(console.warn("[Telegram.WebApp] Biometric access was granted by the user, no need to go to settings."),biometricManager):(WebView.postEvent("web_app_biometry_open_settings",!1),biometricManager)},biometricManager}(),LocationManager=function(){var isInited=!1,isLocationAvailable=!1,isAccessRequested=!1,isAccessGranted=!1,locationManager={};Object.defineProperty(locationManager,"isInited",{get:function(){return isInited},enumerable:!0}),Object.defineProperty(locationManager,"isLocationAvailable",{get:function(){return isInited&&isLocationAvailable},enumerable:!0}),Object.defineProperty(locationManager,"isAccessRequested",{get:function(){return isAccessRequested},enumerable:!0}),Object.defineProperty(locationManager,"isAccessGranted",{get:function(){return isAccessRequested&&isAccessGranted},enumerable:!0});var initRequestState={callbacks:[]},getRequestState={callbacks:[]};WebView.onEvent("location_checked",onLocationChecked),WebView.onEvent("location_requested",onLocationRequested);function onLocationChecked(eventType,eventData){if(isInited=!0,eventData.available?(isLocationAvailable=!0,eventData.access_requested?(isAccessRequested=!0,isAccessGranted=!!eventData.access_granted):(isAccessRequested=!1,isAccessGranted=!1)):(isLocationAvailable=!1,isAccessRequested=!1,isAccessGranted=!1),initRequestState.callbacks.length>0){for(var i=0;i<initRequestState.callbacks.length;i++){var callback=initRequestState.callbacks[i];callback()}initRequestState.callbacks=[]}receiveWebViewEvent("locationManagerUpdated")}function onLocationRequested(eventType,eventData){if(!eventData.available)locationData=null;else{var locationData={latitude:eventData.latitude,longitude:eventData.longitude,altitude:null,course:null,speed:null,horizontal_accuracy:null,vertical_accuracy:null,course_accuracy:null,speed_accuracy:null};typeof eventData.altitude<"u"&&eventData.altitude!==null&&(locationData.altitude=eventData.altitude),typeof eventData.course<"u"&&eventData.course!==null&&(locationData.course=eventData.course%360),typeof eventData.speed<"u"&&eventData.speed!==null&&(locationData.speed=eventData.speed),typeof eventData.horizontal_accuracy<"u"&&eventData.horizontal_accuracy!==null&&(locationData.horizontal_accuracy=eventData.horizontal_accuracy),typeof eventData.vertical_accuracy<"u"&&eventData.vertical_accuracy!==null&&(locationData.vertical_accuracy=eventData.vertical_accuracy),typeof eventData.course_accuracy<"u"&&eventData.course_accuracy!==null&&(locationData.course_accuracy=eventData.course_accuracy),typeof eventData.speed_accuracy<"u"&&eventData.speed_accuracy!==null&&(locationData.speed_accuracy=eventData.speed_accuracy)}!eventData.available||!isLocationAvailable||!isAccessRequested||!isAccessGranted?(initRequestState.callbacks.push(function(){locationResponse(locationData)}),WebView.postEvent("web_app_check_location",!1)):locationResponse(locationData)}function locationResponse(response){if(getRequestState.callbacks.length>0){for(var i=0;i<getRequestState.callbacks.length;i++){var callback=getRequestState.callbacks[i];callback(response)}getRequestState.callbacks=[]}response!==null&&receiveWebViewEvent("locationRequested",{locationData:response})}function checkVersion(){return versionAtLeast("8.0")?!0:(console.warn("[Telegram.WebApp] LocationManager is not supported in version "+webAppVersion),!1)}function checkInit(){if(!isInited)throw console.error("[Telegram.WebApp] LocationManager should be inited before using."),Error("WebAppLocationManagerNotInited");return!0}return locationManager.init=function(callback){return!checkVersion()||isInited||(callback&&initRequestState.callbacks.push(callback),WebView.postEvent("web_app_check_location",!1)),locationManager},locationManager.getLocation=function(callback){if(!checkVersion())return locationManager;if(checkInit(),!isLocationAvailable)throw console.error("[Telegram.WebApp] Location is not available on this device."),Error("WebAppLocationManagerLocationNotAvailable");return getRequestState.callbacks.push(callback),WebView.postEvent("web_app_request_location"),locationManager},locationManager.openSettings=function(){if(!checkVersion())return locationManager;if(checkInit(),!isLocationAvailable)throw console.error("[Telegram.WebApp] Location is not available on this device."),Error("WebAppLocationManagerLocationNotAvailable");if(!isAccessRequested)throw console.error("[Telegram.WebApp] Location access was not requested yet."),Error("WebAppLocationManagerLocationAccessNotRequested");return isAccessGranted?(console.warn("[Telegram.WebApp] Location access was granted by the user, no need to go to settings."),locationManager):(WebView.postEvent("web_app_open_location_settings",!1),locationManager)},locationManager}(),Accelerometer=function(){var isStarted=!1,valueX=null,valueY=null,valueZ=null,startCallbacks=[],stopCallbacks=[],accelerometer={};Object.defineProperty(accelerometer,"isStarted",{get:function(){return isStarted},enumerable:!0}),Object.defineProperty(accelerometer,"x",{get:function(){return valueX},enumerable:!0}),Object.defineProperty(accelerometer,"y",{get:function(){return valueY},enumerable:!0}),Object.defineProperty(accelerometer,"z",{get:function(){return valueZ},enumerable:!0}),WebView.onEvent("accelerometer_started",onAccelerometerStarted),WebView.onEvent("accelerometer_stopped",onAccelerometerStopped),WebView.onEvent("accelerometer_changed",onAccelerometerChanged),WebView.onEvent("accelerometer_failed",onAccelerometerFailed);function onAccelerometerStarted(eventType,eventData){if(isStarted=!0,startCallbacks.length>0){for(var i=0;i<startCallbacks.length;i++){var callback=startCallbacks[i];callback(!0)}startCallbacks=[]}receiveWebViewEvent("accelerometerStarted")}function onAccelerometerStopped(eventType,eventData){if(isStarted=!1,stopCallbacks.length>0){for(var i=0;i<stopCallbacks.length;i++){var callback=stopCallbacks[i];callback(!0)}stopCallbacks=[]}receiveWebViewEvent("accelerometerStopped")}function onAccelerometerChanged(eventType,eventData){valueX=eventData.x,valueY=eventData.y,valueZ=eventData.z,receiveWebViewEvent("accelerometerChanged")}function onAccelerometerFailed(eventType,eventData){if(startCallbacks.length>0){for(var i=0;i<startCallbacks.length;i++){var callback=startCallbacks[i];callback(!1)}startCallbacks=[]}receiveWebViewEvent("accelerometerFailed",{error:eventData.error})}function checkVersion(){return versionAtLeast("8.0")?!0:(console.warn("[Telegram.WebApp] Accelerometer is not supported in version "+webAppVersion),!1)}return accelerometer.start=function(params,callback){if(params=params||{},!checkVersion())return accelerometer;var req_params={},refresh_rate=parseInt(params.refresh_rate||1e3);return isNaN(refresh_rate)||refresh_rate<20||refresh_rate>1e3?console.warn("[Telegram.WebApp] Accelerometer refresh_rate is invalid",refresh_rate):req_params.refresh_rate=refresh_rate,callback&&startCallbacks.push(callback),WebView.postEvent("web_app_start_accelerometer",!1,req_params),accelerometer},accelerometer.stop=function(callback){return checkVersion()&&(callback&&stopCallbacks.push(callback),WebView.postEvent("web_app_stop_accelerometer")),accelerometer},accelerometer}(),DeviceOrientation=function(){var isStarted=!1,valueAlpha=null,valueBeta=null,valueGamma=null,valueAbsolute=!1,startCallbacks=[],stopCallbacks=[],deviceOrientation={};Object.defineProperty(deviceOrientation,"isStarted",{get:function(){return isStarted},enumerable:!0}),Object.defineProperty(deviceOrientation,"absolute",{get:function(){return valueAbsolute},enumerable:!0}),Object.defineProperty(deviceOrientation,"alpha",{get:function(){return valueAlpha},enumerable:!0}),Object.defineProperty(deviceOrientation,"beta",{get:function(){return valueBeta},enumerable:!0}),Object.defineProperty(deviceOrientation,"gamma",{get:function(){return valueGamma},enumerable:!0}),WebView.onEvent("device_orientation_started",onDeviceOrientationStarted),WebView.onEvent("device_orientation_stopped",onDeviceOrientationStopped),WebView.onEvent("device_orientation_changed",onDeviceOrientationChanged),WebView.onEvent("device_orientation_failed",onDeviceOrientationFailed);function onDeviceOrientationStarted(eventType,eventData){if(isStarted=!0,startCallbacks.length>0){for(var i=0;i<startCallbacks.length;i++){var callback=startCallbacks[i];callback(!0)}startCallbacks=[]}receiveWebViewEvent("deviceOrientationStarted")}function onDeviceOrientationStopped(eventType,eventData){if(isStarted=!1,stopCallbacks.length>0){for(var i=0;i<stopCallbacks.length;i++){var callback=stopCallbacks[i];callback(!0)}stopCallbacks=[]}receiveWebViewEvent("deviceOrientationStopped")}function onDeviceOrientationChanged(eventType,eventData){valueAbsolute=!!eventData.absolute,valueAlpha=eventData.alpha,valueBeta=eventData.beta,valueGamma=eventData.gamma,receiveWebViewEvent("deviceOrientationChanged")}function onDeviceOrientationFailed(eventType,eventData){if(startCallbacks.length>0){for(var i=0;i<startCallbacks.length;i++){var callback=startCallbacks[i];callback(!1)}startCallbacks=[]}receiveWebViewEvent("deviceOrientationFailed",{error:eventData.error})}function checkVersion(){return versionAtLeast("8.0")?!0:(console.warn("[Telegram.WebApp] DeviceOrientation is not supported in version "+webAppVersion),!1)}return deviceOrientation.start=function(params,callback){if(params=params||{},!checkVersion())return deviceOrientation;var req_params={},refresh_rate=parseInt(params.refresh_rate||1e3);return isNaN(refresh_rate)||refresh_rate<20||refresh_rate>1e3?console.warn("[Telegram.WebApp] DeviceOrientation refresh_rate is invalid",refresh_rate):req_params.refresh_rate=refresh_rate,req_params.need_absolute=!!params.need_absolute,callback&&startCallbacks.push(callback),WebView.postEvent("web_app_start_device_orientation",!1,req_params),deviceOrientation},deviceOrientation.stop=function(callback){return checkVersion()&&(callback&&stopCallbacks.push(callback),WebView.postEvent("web_app_stop_device_orientation")),deviceOrientation},deviceOrientation}(),Gyroscope=function(){var isStarted=!1,valueX=null,valueY=null,valueZ=null,startCallbacks=[],stopCallbacks=[],gyroscope={};Object.defineProperty(gyroscope,"isStarted",{get:function(){return isStarted},enumerable:!0}),Object.defineProperty(gyroscope,"x",{get:function(){return valueX},enumerable:!0}),Object.defineProperty(gyroscope,"y",{get:function(){return valueY},enumerable:!0}),Object.defineProperty(gyroscope,"z",{get:function(){return valueZ},enumerable:!0}),WebView.onEvent("gyroscope_started",onGyroscopeStarted),WebView.onEvent("gyroscope_stopped",onGyroscopeStopped),WebView.onEvent("gyroscope_changed",onGyroscopeChanged),WebView.onEvent("gyroscope_failed",onGyroscopeFailed);function onGyroscopeStarted(eventType,eventData){if(isStarted=!0,startCallbacks.length>0){for(var i=0;i<startCallbacks.length;i++){var callback=startCallbacks[i];callback(!0)}startCallbacks=[]}receiveWebViewEvent("gyroscopeStarted")}function onGyroscopeStopped(eventType,eventData){if(isStarted=!1,stopCallbacks.length>0){for(var i=0;i<stopCallbacks.length;i++){var callback=stopCallbacks[i];callback(!0)}stopCallbacks=[]}receiveWebViewEvent("gyroscopeStopped")}function onGyroscopeChanged(eventType,eventData){valueX=eventData.x,valueY=eventData.y,valueZ=eventData.z,receiveWebViewEvent("gyroscopeChanged")}function onGyroscopeFailed(eventType,eventData){if(startCallbacks.length>0){for(var i=0;i<startCallbacks.length;i++){var callback=startCallbacks[i];callback(!1)}startCallbacks=[]}receiveWebViewEvent("gyroscopeFailed",{error:eventData.error})}function checkVersion(){return versionAtLeast("8.0")?!0:(console.warn("[Telegram.WebApp] Gyroscope is not supported in version "+webAppVersion),!1)}return gyroscope.start=function(params,callback){if(params=params||{},!checkVersion())return gyroscope;var req_params={},refresh_rate=parseInt(params.refresh_rate||1e3);return isNaN(refresh_rate)||refresh_rate<20||refresh_rate>1e3?console.warn("[Telegram.WebApp] Gyroscope refresh_rate is invalid",refresh_rate):req_params.refresh_rate=refresh_rate,callback&&startCallbacks.push(callback),WebView.postEvent("web_app_start_gyroscope",!1,req_params),gyroscope},gyroscope.stop=function(callback){return checkVersion()&&(callback&&stopCallbacks.push(callback),WebView.postEvent("web_app_stop_gyroscope")),gyroscope},gyroscope}(),webAppInvoices={};function onInvoiceClosed(eventType,eventData){if(eventData.slug&&webAppInvoices[eventData.slug]){var invoiceData=webAppInvoices[eventData.slug];delete webAppInvoices[eventData.slug],invoiceData.callback&&invoiceData.callback(eventData.status),receiveWebViewEvent("invoiceClosed",{url:invoiceData.url,status:eventData.status})}}var webAppPopupOpened=!1;function onPopupClosed(eventType,eventData){if(webAppPopupOpened){var popupData=webAppPopupOpened;webAppPopupOpened=!1;var button_id=null;typeof eventData.button_id<"u"&&(button_id=eventData.button_id),popupData.callback&&popupData.callback(button_id),receiveWebViewEvent("popupClosed",{button_id})}}var webAppScanQrPopupOpened=!1;function onQrTextReceived(eventType,eventData){if(webAppScanQrPopupOpened){var popupData=webAppScanQrPopupOpened,data=null;typeof eventData.data<"u"&&(data=eventData.data),popupData.callback&&popupData.callback(data)&&(webAppScanQrPopupOpened=!1,WebView.postEvent("web_app_close_scan_qr_popup",!1)),receiveWebViewEvent("qrTextReceived",{data})}}function onScanQrPopupClosed(eventType,eventData){webAppScanQrPopupOpened=!1,receiveWebViewEvent("scanQrPopupClosed")}function onClipboardTextReceived(eventType,eventData){if(eventData.req_id&&webAppCallbacks[eventData.req_id]){var requestData=webAppCallbacks[eventData.req_id];delete webAppCallbacks[eventData.req_id];var data=null;typeof eventData.data<"u"&&(data=eventData.data),requestData.callback&&requestData.callback(data),receiveWebViewEvent("clipboardTextReceived",{data})}}var WebAppWriteAccessRequested=!1;function onWriteAccessRequested(eventType,eventData){if(WebAppWriteAccessRequested){var requestData=WebAppWriteAccessRequested;WebAppWriteAccessRequested=!1,requestData.callback&&requestData.callback(eventData.status=="allowed"),receiveWebViewEvent("writeAccessRequested",{status:eventData.status})}}function getRequestedContact(callback,timeout2){var reqTo,fallbackTo,reqDelay=0,reqInvoke=function(){invokeCustomMethod("getRequestedContact",{},function(err,res){res&&res.length?(clearTimeout(fallbackTo),callback(res)):(reqDelay+=50,reqTo=setTimeout(reqInvoke,reqDelay))})},fallbackInvoke=function(){clearTimeout(reqTo),callback("")};fallbackTo=setTimeout(fallbackInvoke,timeout2),reqInvoke()}var WebAppContactRequested=!1;function onPhoneRequested(eventType,eventData){if(WebAppContactRequested){var requestData=WebAppContactRequested;WebAppContactRequested=!1;var requestSent=eventData.status=="sent",webViewEvent={status:eventData.status};requestSent?getRequestedContact(function(res){if(res&&res.length){webViewEvent.response=res,webViewEvent.responseUnsafe=Utils.urlParseQueryString(res);for(var key2 in webViewEvent.responseUnsafe){var val2=webViewEvent.responseUnsafe[key2];try{(val2.substr(0,1)=="{"&&val2.substr(-1)=="}"||val2.substr(0,1)=="["&&val2.substr(-1)=="]")&&(webViewEvent.responseUnsafe[key2]=JSON.parse(val2))}catch{}}}requestData.callback&&requestData.callback(requestSent,webViewEvent),receiveWebViewEvent("contactRequested",webViewEvent)},3e3):(requestData.callback&&requestData.callback(requestSent,webViewEvent),receiveWebViewEvent("contactRequested",webViewEvent))}}var webAppDownloadFileRequested=!1;function onFileDownloadRequested(eventType,eventData){if(webAppDownloadFileRequested){var requestData=webAppDownloadFileRequested;webAppDownloadFileRequested=!1;var isDownloading=eventData.status=="downloading";requestData.callback&&requestData.callback(isDownloading),receiveWebViewEvent("fileDownloadRequested",{status:isDownloading?"downloading":"cancelled"})}}function onCustomMethodInvoked(eventType,eventData){if(eventData.req_id&&webAppCallbacks[eventData.req_id]){var requestData=webAppCallbacks[eventData.req_id];delete webAppCallbacks[eventData.req_id];var res=null,err=null;typeof eventData.result<"u"&&(res=eventData.result),typeof eventData.error<"u"&&(err=eventData.error),requestData.callback&&requestData.callback(err,res)}}function invokeCustomMethod(method,params,callback){if(!versionAtLeast("6.9"))throw console.error("[Telegram.WebApp] Method invokeCustomMethod is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");var req_id=generateCallbackId(16),req_params={req_id,method,params:params||{}};webAppCallbacks[req_id]={callback},WebView.postEvent("web_app_invoke_custom_method",!1,req_params)}return window.Telegram||(window.Telegram={}),Object.defineProperty(WebApp,"initData",{get:function(){return webAppInitData},enumerable:!0}),Object.defineProperty(WebApp,"initDataUnsafe",{get:function(){return webAppInitDataUnsafe},enumerable:!0}),Object.defineProperty(WebApp,"version",{get:function(){return webAppVersion},enumerable:!0}),Object.defineProperty(WebApp,"platform",{get:function(){return webAppPlatform},enumerable:!0}),Object.defineProperty(WebApp,"colorScheme",{get:function(){return colorScheme},enumerable:!0}),Object.defineProperty(WebApp,"themeParams",{get:function(){return themeParams},enumerable:!0}),Object.defineProperty(WebApp,"isExpanded",{get:function(){return isExpanded},enumerable:!0}),Object.defineProperty(WebApp,"viewportHeight",{get:function(){return(viewportHeight===!1?window.innerHeight:viewportHeight)-bottomBarHeight},enumerable:!0}),Object.defineProperty(WebApp,"viewportStableHeight",{get:function(){return(viewportStableHeight===!1?window.innerHeight:viewportStableHeight)-bottomBarHeight},enumerable:!0}),Object.defineProperty(WebApp,"safeAreaInset",{get:function(){return safeAreaInset},enumerable:!0}),Object.defineProperty(WebApp,"contentSafeAreaInset",{get:function(){return contentSafeAreaInset},enumerable:!0}),Object.defineProperty(WebApp,"isClosingConfirmationEnabled",{set:function(val2){setClosingConfirmation(val2)},get:function(){return isClosingConfirmationEnabled},enumerable:!0}),Object.defineProperty(WebApp,"isVerticalSwipesEnabled",{set:function(val2){toggleVerticalSwipes(val2)},get:function(){return isVerticalSwipesEnabled},enumerable:!0}),Object.defineProperty(WebApp,"isFullscreen",{get:function(){return webAppIsFullscreen},enumerable:!0}),Object.defineProperty(WebApp,"isOrientationLocked",{set:function(val2){toggleOrientationLock(val2)},get:function(){return webAppIsOrientationLocked},enumerable:!0}),Object.defineProperty(WebApp,"isActive",{get:function(){return webAppIsActive},enumerable:!0}),Object.defineProperty(WebApp,"headerColor",{set:function(val2){setHeaderColor(val2)},get:function(){return getHeaderColor()},enumerable:!0}),Object.defineProperty(WebApp,"backgroundColor",{set:function(val2){setBackgroundColor(val2)},get:function(){return getBackgroundColor()},enumerable:!0}),Object.defineProperty(WebApp,"bottomBarColor",{set:function(val2){setBottomBarColor(val2)},get:function(){return getBottomBarColor()},enumerable:!0}),Object.defineProperty(WebApp,"BackButton",{value:BackButton,enumerable:!0}),Object.defineProperty(WebApp,"MainButton",{value:MainButton,enumerable:!0}),Object.defineProperty(WebApp,"SecondaryButton",{value:SecondaryButton,enumerable:!0}),Object.defineProperty(WebApp,"SettingsButton",{value:SettingsButton,enumerable:!0}),Object.defineProperty(WebApp,"HapticFeedback",{value:HapticFeedback,enumerable:!0}),Object.defineProperty(WebApp,"CloudStorage",{value:CloudStorage,enumerable:!0}),Object.defineProperty(WebApp,"DeviceStorage",{value:DeviceStorage,enumerable:!0}),Object.defineProperty(WebApp,"SecureStorage",{value:SecureStorage,enumerable:!0}),Object.defineProperty(WebApp,"BiometricManager",{value:BiometricManager,enumerable:!0}),Object.defineProperty(WebApp,"Accelerometer",{value:Accelerometer,enumerable:!0}),Object.defineProperty(WebApp,"DeviceOrientation",{value:DeviceOrientation,enumerable:!0}),Object.defineProperty(WebApp,"Gyroscope",{value:Gyroscope,enumerable:!0}),Object.defineProperty(WebApp,"LocationManager",{value:LocationManager,enumerable:!0}),WebApp.isVersionAtLeast=function(ver){return versionAtLeast(ver)},WebApp.setHeaderColor=function(color_key){WebApp.headerColor=color_key},WebApp.setBackgroundColor=function(color){WebApp.backgroundColor=color},WebApp.setBottomBarColor=function(color){WebApp.bottomBarColor=color},WebApp.enableClosingConfirmation=function(){WebApp.isClosingConfirmationEnabled=!0},WebApp.disableClosingConfirmation=function(){WebApp.isClosingConfirmationEnabled=!1},WebApp.enableVerticalSwipes=function(){WebApp.isVerticalSwipesEnabled=!0},WebApp.disableVerticalSwipes=function(){WebApp.isVerticalSwipesEnabled=!1},WebApp.lockOrientation=function(){WebApp.isOrientationLocked=!0},WebApp.unlockOrientation=function(){WebApp.isOrientationLocked=!1},WebApp.requestFullscreen=function(){if(!versionAtLeast("8.0"))throw console.error("[Telegram.WebApp] Method requestFullscreen is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");WebView.postEvent("web_app_request_fullscreen")},WebApp.exitFullscreen=function(){if(!versionAtLeast("8.0"))throw console.error("[Telegram.WebApp] Method exitFullscreen is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");WebView.postEvent("web_app_exit_fullscreen")},WebApp.addToHomeScreen=function(){if(!versionAtLeast("8.0"))throw console.error("[Telegram.WebApp] Method addToHomeScreen is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");WebView.postEvent("web_app_add_to_home_screen")},WebApp.checkHomeScreenStatus=function(callback){if(!versionAtLeast("8.0"))throw console.error("[Telegram.WebApp] Method checkHomeScreenStatus is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");callback&&homeScreenCallbacks.push(callback),WebView.postEvent("web_app_check_home_screen")},WebApp.onEvent=function(eventType,callback){onWebViewEvent(eventType,callback)},WebApp.offEvent=function(eventType,callback){offWebViewEvent(eventType,callback)},WebApp.sendData=function(data){if(!data||!data.length)throw console.error("[Telegram.WebApp] Data is required",data),Error("WebAppDataInvalid");if(byteLength(data)>4096)throw console.error("[Telegram.WebApp] Data is too long",data),Error("WebAppDataInvalid");WebView.postEvent("web_app_data_send",!1,{data})},WebApp.switchInlineQuery=function(query,choose_chat_types){if(!versionAtLeast("6.6"))throw console.error("[Telegram.WebApp] Method switchInlineQuery is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");if(!initParams.tgWebAppBotInline)throw console.error("[Telegram.WebApp] Inline mode is disabled for this bot. Read more about inline mode: https://core.telegram.org/bots/inline"),Error("WebAppInlineModeDisabled");if(query=query||"",query.length>256)throw console.error("[Telegram.WebApp] Inline query is too long",query),Error("WebAppInlineQueryInvalid");var chat_types=[];if(choose_chat_types){if(!Array.isArray(choose_chat_types))throw console.error("[Telegram.WebApp] Choose chat types should be an array",choose_chat_types),Error("WebAppInlineChooseChatTypesInvalid");for(var good_types={users:1,bots:1,groups:1,channels:1},i=0;i<choose_chat_types.length;i++){var chat_type=choose_chat_types[i];if(!good_types[chat_type])throw console.error("[Telegram.WebApp] Choose chat type is invalid",chat_type),Error("WebAppInlineChooseChatTypeInvalid");good_types[chat_type]!=2&&(good_types[chat_type]=2,chat_types.push(chat_type))}}WebView.postEvent("web_app_switch_inline_query",!1,{query,chat_types})},WebApp.openLink=function(url2,options){var a=document.createElement("A");if(a.href=url2,a.protocol!="http:"&&a.protocol!="https:")throw console.error("[Telegram.WebApp] Url protocol is not supported",url2),Error("WebAppTgUrlInvalid");var url2=a.href;if(options=options||{},versionAtLeast("6.1")){var req_params={url:url2};versionAtLeast("6.4")&&options.try_instant_view&&(req_params.try_instant_view=!0),versionAtLeast("7.6")&&options.try_browser&&(req_params.try_browser=options.try_browser),WebView.postEvent("web_app_open_link",!1,req_params)}else window.open(url2,"_blank")},WebApp.openTelegramLink=function(url2,options){var a=document.createElement("A");if(a.href=url2,a.protocol!="http:"&&a.protocol!="https:")throw console.error("[Telegram.WebApp] Url protocol is not supported",url2),Error("WebAppTgUrlInvalid");if(a.hostname!="t.me")throw console.error("[Telegram.WebApp] Url host is not supported",url2),Error("WebAppTgUrlInvalid");var path_full=a.pathname+a.search;if(options=options||{},isIframe||versionAtLeast("6.1")){var req_params={path_full};options.force_request&&(req_params.force_request=!0),WebView.postEvent("web_app_open_tg_link",!1,req_params)}else location.href="https://t.me"+path_full},WebApp.openInvoice=function(url2,callback){var a=document.createElement("A"),match,slug;if(a.href=url2,a.protocol!="http:"&&a.protocol!="https:"||a.hostname!="t.me"||!(match=a.pathname.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/))||!(slug=match[2]))throw console.error("[Telegram.WebApp] Invoice url is invalid",url2),Error("WebAppInvoiceUrlInvalid");if(!versionAtLeast("6.1"))throw console.error("[Telegram.WebApp] Method openInvoice is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");if(webAppInvoices[slug])throw console.error("[Telegram.WebApp] Invoice is already opened"),Error("WebAppInvoiceOpened");webAppInvoices[slug]={url:url2,callback},WebView.postEvent("web_app_open_invoice",!1,{slug})},WebApp.showPopup=function(params,callback){if(!versionAtLeast("6.2"))throw console.error("[Telegram.WebApp] Method showPopup is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");if(webAppPopupOpened)throw console.error("[Telegram.WebApp] Popup is already opened"),Error("WebAppPopupOpened");var title="",message="",buttons=[],popup_params={};if(typeof params.title<"u"){if(title=strTrim(params.title),title.length>64)throw console.error("[Telegram.WebApp] Popup title is too long",title),Error("WebAppPopupParamInvalid");title.length>0&&(popup_params.title=title)}if(typeof params.message<"u"&&(message=strTrim(params.message)),!message.length)throw console.error("[Telegram.WebApp] Popup message is required",params.message),Error("WebAppPopupParamInvalid");if(message.length>256)throw console.error("[Telegram.WebApp] Popup message is too long",message),Error("WebAppPopupParamInvalid");if(popup_params.message=message,typeof params.buttons<"u"){if(!Array.isArray(params.buttons))throw console.error("[Telegram.WebApp] Popup buttons should be an array",params.buttons),Error("WebAppPopupParamInvalid");for(var i=0;i<params.buttons.length;i++){var button=params.buttons[i],btn={},id="";if(typeof button.id<"u"&&(id=button.id.toString(),id.length>64))throw console.error("[Telegram.WebApp] Popup button id is too long",id),Error("WebAppPopupParamInvalid");btn.id=id;var button_type=button.type;if(typeof button_type>"u"&&(button_type="default"),btn.type=button_type,!(button_type=="ok"||button_type=="close"||button_type=="cancel"))if(button_type=="default"||button_type=="destructive"){var text="";if(typeof button.text<"u"&&(text=strTrim(button.text)),!text.length)throw console.error("[Telegram.WebApp] Popup button text is required for type "+button_type,button.text),Error("WebAppPopupParamInvalid");if(text.length>64)throw console.error("[Telegram.WebApp] Popup button text is too long",text),Error("WebAppPopupParamInvalid");btn.text=text}else throw console.error("[Telegram.WebApp] Popup button type is invalid",button_type),Error("WebAppPopupParamInvalid");buttons.push(btn)}}else buttons.push({id:"",type:"close"});if(buttons.length<1)throw console.error("[Telegram.WebApp] Popup should have at least one button"),Error("WebAppPopupParamInvalid");if(buttons.length>3)throw console.error("[Telegram.WebApp] Popup should not have more than 3 buttons"),Error("WebAppPopupParamInvalid");popup_params.buttons=buttons,webAppPopupOpened={callback},WebView.postEvent("web_app_open_popup",!1,popup_params)},WebApp.showAlert=function(message,callback){WebApp.showPopup({message},callback?function(){callback()}:null)},WebApp.showConfirm=function(message,callback){WebApp.showPopup({message,buttons:[{type:"ok",id:"ok"},{type:"cancel"}]},callback?function(button_id){callback(button_id=="ok")}:null)},WebApp.showScanQrPopup=function(params,callback){if(!versionAtLeast("6.4"))throw console.error("[Telegram.WebApp] Method showScanQrPopup is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");if(webAppScanQrPopupOpened)throw console.error("[Telegram.WebApp] Popup is already opened"),Error("WebAppScanQrPopupOpened");var text="",popup_params={};if(typeof params.text<"u"){if(text=strTrim(params.text),text.length>64)throw console.error("[Telegram.WebApp] Scan QR popup text is too long",text),Error("WebAppScanQrPopupParamInvalid");text.length>0&&(popup_params.text=text)}webAppScanQrPopupOpened={callback},WebView.postEvent("web_app_open_scan_qr_popup",!1,popup_params)},WebApp.closeScanQrPopup=function(){if(!versionAtLeast("6.4"))throw console.error("[Telegram.WebApp] Method closeScanQrPopup is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");webAppScanQrPopupOpened=!1,WebView.postEvent("web_app_close_scan_qr_popup",!1)},WebApp.readTextFromClipboard=function(callback){if(!versionAtLeast("6.4"))throw console.error("[Telegram.WebApp] Method readTextFromClipboard is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");var req_id=generateCallbackId(16),req_params={req_id};webAppCallbacks[req_id]={callback},WebView.postEvent("web_app_read_text_from_clipboard",!1,req_params)},WebApp.requestWriteAccess=function(callback){if(!versionAtLeast("6.9"))throw console.error("[Telegram.WebApp] Method requestWriteAccess is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");if(WebAppWriteAccessRequested)throw console.error("[Telegram.WebApp] Write access is already requested"),Error("WebAppWriteAccessRequested");WebAppWriteAccessRequested={callback},WebView.postEvent("web_app_request_write_access")},WebApp.requestContact=function(callback){if(!versionAtLeast("6.9"))throw console.error("[Telegram.WebApp] Method requestContact is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");if(WebAppContactRequested)throw console.error("[Telegram.WebApp] Contact is already requested"),Error("WebAppContactRequested");WebAppContactRequested={callback},WebView.postEvent("web_app_request_phone")},WebApp.downloadFile=function(params,callback){if(!versionAtLeast("8.0"))throw console.error("[Telegram.WebApp] Method downloadFile is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");if(webAppDownloadFileRequested)throw console.error("[Telegram.WebApp] Popup is already opened"),Error("WebAppDownloadFilePopupOpened");var a=document.createElement("A"),dl_params={};if(!params||!params.url||!params.url.length)throw console.error("[Telegram.WebApp] Url is required"),Error("WebAppDownloadFileParamInvalid");if(a.href=params.url,a.protocol!="https:")throw console.error("[Telegram.WebApp] Url protocol is not supported",url),Error("WebAppDownloadFileParamInvalid");if(dl_params.url=a.href,!params||!params.file_name||!params.file_name.length)throw console.error("[Telegram.WebApp] File name is required"),Error("WebAppDownloadFileParamInvalid");dl_params.file_name=params.file_name,webAppDownloadFileRequested={callback},WebView.postEvent("web_app_request_file_download",!1,dl_params)},WebApp.shareToStory=function(media_url,params){if(params=params||{},!versionAtLeast("7.8"))throw console.error("[Telegram.WebApp] Method shareToStory is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");var a=document.createElement("A");if(a.href=media_url,a.protocol!="http:"&&a.protocol!="https:")throw console.error("[Telegram.WebApp] Media url protocol is not supported",url),Error("WebAppMediaUrlInvalid");var share_params={};if(share_params.media_url=a.href,typeof params.text<"u"){var text=strTrim(params.text);if(text.length>2048)throw console.error("[Telegram.WebApp] Text is too long",text),Error("WebAppShareToStoryParamInvalid");text.length>0&&(share_params.text=text)}if(typeof params.widget_link<"u"){if(params.widget_link=params.widget_link||{},a.href=params.widget_link.url,a.protocol!="http:"&&a.protocol!="https:")throw console.error("[Telegram.WebApp] Link protocol is not supported",url),Error("WebAppShareToStoryParamInvalid");var widget_link={url:a.href};if(typeof params.widget_link.name<"u"){var link_name=strTrim(params.widget_link.name);if(link_name.length>48)throw console.error("[Telegram.WebApp] Link name is too long",link_name),Error("WebAppShareToStoryParamInvalid");link_name.length>0&&(widget_link.name=link_name)}share_params.widget_link=widget_link}WebView.postEvent("web_app_share_to_story",!1,share_params)},WebApp.shareMessage=function(msg_id,callback){if(!versionAtLeast("8.0"))throw console.error("[Telegram.WebApp] Method shareMessage is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");if(WebAppShareMessageOpened)throw console.error("[Telegram.WebApp] Share message is already opened"),Error("WebAppShareMessageOpened");WebAppShareMessageOpened={callback},WebView.postEvent("web_app_send_prepared_message",!1,{id:msg_id})},WebApp.setEmojiStatus=function(custom_emoji_id,params,callback){if(params=params||{},!versionAtLeast("8.0"))throw console.error("[Telegram.WebApp] Method setEmojiStatus is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");var status_params={};if(status_params.custom_emoji_id=custom_emoji_id,typeof params.duration<"u"&&(status_params.duration=params.duration),WebAppEmojiStatusRequested)throw console.error("[Telegram.WebApp] Emoji status is already requested"),Error("WebAppEmojiStatusRequested");WebAppEmojiStatusRequested={callback},WebView.postEvent("web_app_set_emoji_status",!1,status_params)},WebApp.requestEmojiStatusAccess=function(callback){if(!versionAtLeast("8.0"))throw console.error("[Telegram.WebApp] Method requestEmojiStatusAccess is not supported in version "+webAppVersion),Error("WebAppMethodUnsupported");if(WebAppEmojiStatusAccessRequested)throw console.error("[Telegram.WebApp] Emoji status permission is already requested"),Error("WebAppEmojiStatusAccessRequested");WebAppEmojiStatusAccessRequested={callback},WebView.postEvent("web_app_request_emoji_status_access")},WebApp.invokeCustomMethod=function(method,params,callback){invokeCustomMethod(method,params,callback)},WebApp.ready=function(){WebView.postEvent("web_app_ready")},WebApp.expand=function(){WebView.postEvent("web_app_expand")},WebApp.close=function(options){options=options||{};var req_params={};versionAtLeast("7.6")&&options.return_back&&(req_params.return_back=!0),WebView.postEvent("web_app_close",!1,req_params)},window.Telegram.WebApp=WebApp,updateHeaderColor(),updateBackgroundColor(),updateBottomBarColor(),setViewportHeight(),initParams.tgWebAppShowSettings&&SettingsButton.show(),window.addEventListener("resize",onWindowResize),isIframe&&document.addEventListener("click",linkHandler),WebView.onEvent("theme_changed",onThemeChanged),WebView.onEvent("viewport_changed",onViewportChanged),WebView.onEvent("safe_area_changed",onSafeAreaChanged),WebView.onEvent("content_safe_area_changed",onContentSafeAreaChanged),WebView.onEvent("visibility_changed",onVisibilityChanged),WebView.onEvent("invoice_closed",onInvoiceClosed),WebView.onEvent("popup_closed",onPopupClosed),WebView.onEvent("qr_text_received",onQrTextReceived),WebView.onEvent("scan_qr_popup_closed",onScanQrPopupClosed),WebView.onEvent("clipboard_text_received",onClipboardTextReceived),WebView.onEvent("write_access_requested",onWriteAccessRequested),WebView.onEvent("phone_requested",onPhoneRequested),WebView.onEvent("file_download_requested",onFileDownloadRequested),WebView.onEvent("custom_method_invoked",onCustomMethodInvoked),WebView.onEvent("fullscreen_changed",onFullscreenChanged),WebView.onEvent("fullscreen_failed",onFullscreenFailed),WebView.onEvent("home_screen_added",onHomeScreenAdded),WebView.onEvent("home_screen_checked",onHomeScreenChecked),WebView.onEvent("prepared_message_sent",onPreparedMessageSent),WebView.onEvent("prepared_message_failed",onPreparedMessageFailed),WebView.onEvent("emoji_status_set",onEmojiStatusSet),WebView.onEvent("emoji_status_failed",onEmojiStatusFailed),WebView.onEvent("emoji_status_access_requested",onEmojiStatusAccessRequested),WebView.postEvent("web_app_request_theme"),WebView.postEvent("web_app_request_viewport"),WebView.postEvent("web_app_request_safe_area"),WebView.postEvent("web_app_request_content_safe_area"),window.Telegram.WebApp}const tg=getWebApp(),createStoreImpl=createState=>{let state;const listeners=new Set,setState=(partial,replace)=>{const nextState=typeof partial=="function"?partial(state):partial;if(!Object.is(nextState,state)){const previousState=state;state=replace??(typeof nextState!="object"||nextState===null)?nextState:Object.assign({},state,nextState),listeners.forEach(listener=>listener(state,previousState))}},getState=()=>state,api={setState,getState,getInitialState:()=>initialState,subscribe:listener=>(listeners.add(listener),()=>listeners.delete(listener))},initialState=state=createState(setState,getState,api);return api},createStore=createState=>createStoreImpl;function createJSONStorage(getStorage,options){let storage;try{storage=getStorage()}catch{return}return{getItem:name=>{var _a;const parse=str2=>str2===null?null:JSON.parse(str2,void 0),str=(_a=storage.getItem(name))!=null?_a:null;return str instanceof Promise?str.then(parse):parse(str)},setItem:(name,newValue)=>storage.setItem(name,JSON.stringify(newValue,void 0)),removeItem:name=>storage.removeItem(name)}}const toThenable=fn=>input=>{try{const result=fn(input);return result instanceof Promise?result:{then(onFulfilled){return toThenable(onFulfilled)(result)},catch(_onRejected){return this}}}catch(e){return{then(_onFulfilled){return this},catch(onRejected){return toThenable(onRejected)(e)}}}},persistImpl=(config,baseOptions)=>(set,get,api)=>{let options={storage:createJSONStorage(()=>localStorage),partialize:state=>state,version:0,merge:(persistedState,currentState)=>({...currentState,...persistedState}),...baseOptions},hasHydrated=!1;const hydrationListeners=new Set,finishHydrationListeners=new Set;let storage=options.storage;if(!storage)return config((...args)=>{console.warn(`[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`),set(...args)},get,api);const setItem=()=>{const state=options.partialize({...get()});return storage.setItem(options.name,{state,version:options.version})},savedSetState=api.setState;api.setState=(state,replace)=>(savedSetState(state,replace),setItem());const configResult=config((...args)=>(set(...args),setItem()),get,api);api.getInitialState=()=>configResult;let stateFromStorage;const hydrate=()=>{var _a,_b;if(!storage)return;hasHydrated=!1,hydrationListeners.forEach(cb=>{var _a2;return cb((_a2=get())!=null?_a2:configResult)});const postRehydrationCallback=((_b=options.onRehydrateStorage)==null?void 0:_b.call(options,(_a=get())!=null?_a:configResult))||void 0;return toThenable(storage.getItem.bind(storage))(options.name).then(deserializedStorageValue=>{if(deserializedStorageValue)if(typeof deserializedStorageValue.version=="number"&&deserializedStorageValue.version!==options.version){if(options.migrate){const migration=options.migrate(deserializedStorageValue.state,deserializedStorageValue.version);return migration instanceof Promise?migration.then(result=>[!0,result]):[!0,migration]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,deserializedStorageValue.state];return[!1,void 0]}).then(migrationResult=>{var _a2;const[migrated,migratedState]=migrationResult;if(stateFromStorage=options.merge(migratedState,(_a2=get())!=null?_a2:configResult),set(stateFromStorage,!0),migrated)return setItem()}).then(()=>{postRehydrationCallback?.(stateFromStorage,void 0),stateFromStorage=get(),hasHydrated=!0,finishHydrationListeners.forEach(cb=>cb(stateFromStorage))}).catch(e=>{postRehydrationCallback?.(void 0,e)})};return api.persist={setOptions:newOptions=>{options={...options,...newOptions},newOptions.storage&&(storage=newOptions.storage)},clearStorage:()=>{storage?.removeItem(options.name)},getOptions:()=>options,rehydrate:()=>hydrate(),hasHydrated:()=>hasHydrated,onHydrate:cb=>(hydrationListeners.add(cb),()=>{hydrationListeners.delete(cb)}),onFinishHydration:cb=>(finishHydrationListeners.add(cb),()=>{finishHydrationListeners.delete(cb)})},options.skipHydration||hydrate(),stateFromStorage||configResult},persist=persistImpl,categories=[{id:"category_1",category:" ",items:[{id:"category_1_item_1",title:"  ",contacts:"+70000000001"},{id:"category_1_item_2",title:"    ",contacts:"+70000000002"},{id:"category_1_item_3",title:"   ",contacts:"+70000000003"},{id:"category_1_item_4",title:"  ",contacts:"+70000000004"},{id:"category_1_item_5",title:"  ",contacts:"+70000000005"}]},{id:"category_2",category:"",items:[{id:"category_2_item_1",title:"  ",contacts:"+70000000011"},{id:"category_2_item_2",title:"  ",contacts:"+70000000012"},{id:"category_2_item_3",title:"  ",contacts:"+70000000013"},{id:"category_2_item_4",title:"  ",contacts:"+70000000014"},{id:"category_2_item_5",title:"  ",contacts:"+70000000015"}]},{id:"category_3",category:" ",items:[{id:"category_3_item_1",title:"  ",contacts:"+70000000021"},{id:"category_3_item_2",title:"  ",contacts:"+70000000022"},{id:"category_3_item_3",title:"  ",contacts:"+70000000023"},{id:"category_3_item_4",title:"    ",contacts:"+70000000024"},{id:"category_3_item_5",title:"  ",contacts:"+70000000025"}]},{id:"category_4",category:"",items:[{id:"category_4_item_1",title:"  ",contacts:"+70000000031"},{id:"category_4_item_2",title:"  ",contacts:"+70000000032"},{id:"category_4_item_3",title:"  ",contacts:"+70000000033"},{id:"category_4_item_4",title:"  ",contacts:"+70000000035"},{id:"category_4_item_5",title:"  ",contacts:"+70000000036"}]},{id:"category_5",category:"IT",items:[{id:"category_5_item_1",title:"  ",contacts:"+70000000041"},{id:"category_5_item_2",title:"  ",contacts:"+70000000042"},{id:"category_5_item_3",title:"  ",contacts:"+70000000043"},{id:"category_5_item_4",title:"3D   ",contacts:"+70000000044"},{id:"category_5_item_5",title:" -",contacts:"+70000000045"}]},{id:"category_6",category:"",items:[{id:"category_6_item_1",title:"  ",contacts:"+70000000051"},{id:"category_6_item_2",title:"  ",contacts:"+70000000052"},{id:"category_6_item_3",title:"  ",contacts:"+70000000053"},{id:"category_6_item_4",title:"  ",contacts:"+70000000054"},{id:"category_6_item_5",title:"  ",contacts:"+70000000055"}]},{id:"category_7",category:"",items:[{id:"category_7_item_1",title:"  ",contacts:"+70000000061"},{id:"category_7_item_2",title:"  ABC",contacts:"+70000000062"},{id:"category_7_item_3",title:"  ",contacts:"+70000000063"},{id:"category_7_item_4",title:"  ",contacts:"+70000000064"},{id:"category_7_item_5",title:"  ",contacts:"+70000000065"}]},{id:"category_8",category:"",items:[{id:"category_8_item_1",title:"  ",contacts:"+70000000071"},{id:"category_8_item_2",title:"- ",contacts:"+70000000072"},{id:"category_8_item_3",title:"  ",contacts:"+70000000073"},{id:"category_8_item_4",title:"  ",contacts:"+70000000074"},{id:"category_8_item_5",title:"  ",contacts:"+70000000075"}]},{id:"category_9",category:" ",items:[{id:"category_9_item_1",title:"   ",contacts:"+70000000081"},{id:"category_9_item_2",title:"   ",contacts:"+70000000082"},{id:"category_9_item_3",title:"  ",contacts:"+70000000083"},{id:"category_9_item_4",title:"  ",contacts:"+70000000084"},{id:"category_9_item_5",title:"   ",contacts:"+70000000085"}]}];function timeout(ms=5e3){return new Promise(reject=>{setTimeout(()=>{reject(null)},ms)})}const getCloudStorageProvider=()=>({getItem:async name=>await Promise.race([new Promise((resolve,reject)=>{tg.CloudStorage.getItem(name,(error,value)=>{(error||!value||value==="")&&reject(null);try{resolve(JSON.parse(value))}catch{reject(null)}})}),timeout()]),setItem:async(name,value)=>await Promise.race([new Promise((resolve,reject)=>{tg.CloudStorage.setItem(name,JSON.stringify(value),error=>{error&&reject(new Error(`Error on writing data:
${error}`)),resolve()})}),timeout()]),removeItem:async name=>await Promise.race([new Promise((resolve,reject)=>{tg.CloudStorage.removeItem(name,(error,_)=>{error&&reject(new Error(`Error on clear data:
${error}`)),resolve()})}),timeout()])}),usePuzzleStore=createStore()(persist((set,get)=>({isPending:!1,hasBeenSent:!1,items:{},addItem:(id,puzzleItem)=>set(state=>({items:{...state.items,[id]:puzzleItem}})),updateItemById:(id,updatedPuzzleItem)=>set(state=>({items:{...state.items,[id]:{...state.items[id],...updatedPuzzleItem}}})),getItemById:id=>get().items[id],clearAll:()=>set({items:{},hasBeenSent:!1}),completedIds:()=>Object.keys(get().items),markAsSent:()=>set({hasBeenSent:!0})}),{name:"puzzle",storage:createJSONStorage(getCloudStorageProvider),partialize:({items,hasBeenSent})=>({items,hasBeenSent}),merge:(persistedState,currentState)=>{const persisted=persistedState||{};return{...currentState,items:persisted.items&&Object.keys(persisted.items).length>0?persisted.items:currentState.items,hasBeenSent:persisted.hasBeenSent??currentState.hasBeenSent}}})),useCredentialsStore=createStore()(persist((set,get)=>({isPending:!1,credentials:{first_name:null,last_name:null,phone_number:null},setCredentials:credentials=>set({credentials}),isSet:()=>!!(get().credentials.first_name||get().credentials.phone_number),clearAll:()=>set({credentials:{first_name:null,last_name:null,phone_number:null}})}),{name:"credentials",storage:createJSONStorage(getCloudStorageProvider),partialize:({credentials})=>({credentials}),merge:(persistedState,currentState)=>{const persisted=persistedState||{};return{...currentState,credentials:persisted.credentials&&Object.keys(persisted.credentials).length>0?persisted.credentials:currentState.credentials}}}));function isTimestampPassed(timestamp){return Date.now()>timestamp}function isDatetimePassed(date,time){return Date.now()>Date.parse(`${date}T${time}`)}function isDatePassed(date){return new Date().setHours(0,0,0)>Date.parse(date)}const useLotteryStore=createStore()(persist((set,get)=>({isPending:!1,hasBeenSent:!1,date:null,time:null,setDatetime:({date,time})=>set({date,time}),hasBeenPassed:()=>{const date=get().date,time=get().time;return date!==null&&time!==null?isDatetimePassed(date,time):!1},clearAll:()=>set({date:null,time:null,hasBeenSent:!1}),markAsSent:()=>set({hasBeenSent:!0})}),{name:"lottery",storage:createJSONStorage(getCloudStorageProvider),partialize:state=>({date:state.date,time:state.time,hasBeenSent:state.hasBeenSent}),merge:(persistedState,currentState)=>{const persisted=persistedState||{};return{...currentState,date:persisted.date??currentState.date,time:persisted.time??currentState.time,hasBeenSent:persisted.hasBeenSent??currentState.hasBeenSent}}}));function navigateToCategories(){renderPage("categories")}function navigateToMap(){renderPage("map")}function navigateToLottery(){renderPage("lottery")}function resetAndNavigateToCategories(){usePuzzleStore.getState().clearAll(),useCredentialsStore.getState().clearAll(),useLotteryStore.getState().clearAll(),navigateToCategories()}async function StartPage(){tg.MainButton.setParams({text:" ",color:"#9C8CD9",text_color:"#ffffff",is_active:!0,is_visible:!0}),tg.SecondaryButton.setParams({text:" ",color:"#FF9448",text_color:"#ffffff",is_active:!0,is_visible:!0,position:"bottom"}).onClick(navigateToMap);const puzzleHasBeenSent=usePuzzleStore.getState().hasBeenSent,lotteryHasBeenSent=useLotteryStore.getState().hasBeenSent;useLotteryStore.getState().hasBeenPassed()?tg.MainButton.disable().hide():lotteryHasBeenSent?tg.MainButton.setText("  ").onClick(navigateToLottery):puzzleHasBeenSent?tg.MainButton.setText("  ").onClick(navigateToLottery):tg.MainButton.onClick(navigateToCategories),document.getElementById("clear-btn")?.addEventListener("click",resetAndNavigateToCategories,{once:!0})}function requestContact(text){return new Promise((resolve,reject)=>{tg.showConfirm(text,ok=>{ok?tg.requestContact((success,response)=>{success?resolve(response.responseUnsafe.contact):reject("Cancelled by user")}):reject("Cancelled by user")})})}function renderStatus(completedCount){const statusElement=document.querySelector(".game-status > span");statusElement.innerHTML=completedCount.toString()}function renderCategories(completedCategories){const categoriesElement=document.querySelector(".categories");for(const{id,category}of categories){const buttonElement=categoriesElement.querySelector(`#${id}`);completedCategories.includes(id)&&buttonElement.classList.add("disabled");for(const child of buttonElement.children)child.addEventListener("click",()=>{renderPage("items",category)})}}async function sendPuzzleData(){try{if(!useCredentialsStore.getState().isSet()){const contact=await requestContact("     ");useCredentialsStore.getState().setCredentials({phone_number:contact.phone_number??"",first_name:contact.first_name??"",last_name:contact.last_name??""})}const data={type:"puzzle",payload:usePuzzleStore.getState().items,credentials:useCredentialsStore.getState().credentials};usePuzzleStore.getState().markAsSent(),tg.sendData(JSON.stringify(data))}catch(error){console.log(error)}}function renderButtons(completedCount){tg.MainButton.setParams({text:" ",color:"#FF9448",text_color:"#ffffff",is_active:!1,is_visible:!1}).onClick(sendPuzzleData),tg.BackButton.onClick(()=>{renderPage("start")}).show(),completedCount===categories.length&&tg.MainButton.enable().show()}async function CategoriesPage(){const completedCategories=usePuzzleStore.getState().completedIds();renderStatus(Object.keys(completedCategories).length),renderButtons(Object.keys(completedCategories).length),renderCategories(completedCategories)}function getCheckedElements(formElement){return[...formElement.querySelectorAll("input, textarea")].filter(inputElement=>{if(inputElement.tagName==="INPUT")return inputElement.checked;if(inputElement.tagName==="TEXTAREA")return inputElement.value?.length>3})}function renderEntry(item,checked=!1){const inputElement=document.createElement("input");inputElement.className="title-inp",inputElement.value=item.id,inputElement.type="checkbox",inputElement.checked=checked;const labelElement=document.createElement("label");return labelElement.className="option",labelElement.textContent=item.title,labelElement.prepend(inputElement),labelElement}function FormPage(categoryName){function navigateBack(){renderPage("categories")}function onInput(){const checkedNumber=getCheckedElements(formElement).length;if(checkedNumber>0?tg.MainButton.show().enable():tg.MainButton.hide().disable(),checkedNumber===3)for(const element of optionsElement.querySelectorAll("input:not(:checked)"))element.setAttribute("disabled","disabled");else for(const element of optionsElement.querySelectorAll("input"))element.removeAttribute("disabled")}function onSubmit(){const commentElement2=formElement.querySelector(".form__comment"),commentValue=commentElement2?.value&&commentElement2.value.length>3?commentElement2.value:"",itemsValue=getCheckedElements(formElement).filter(({tagName})=>tagName==="INPUT").map(({value})=>value);try{usePuzzleStore.getState().updateItemById(categoryData.id,{items:itemsValue,comment:commentValue})}catch(error){console.log(error)}renderPage("categories")}const categoryData=categories.find(({category})=>category===categoryName),formElement=document.querySelector(".form"),formHeading=formElement.querySelector(".form__heading"),optionsElement=formElement.querySelector(".form__options"),commentElement=formElement.querySelector(".form__comment"),spinnerElement=formElement.querySelector(".spinner");formHeading.textContent=categoryName,formElement.addEventListener("input",onInput),tg.BackButton.onClick(navigateBack).show(),tg.MainButton.setText("").onClick(onSubmit).hide();const categoryStorage=usePuzzleStore.getState().getItemById(categoryData.id);spinnerElement?.classList.add("hidden");for(const item of categoryData.items){const isChecked=categoryStorage?.items?.includes(item.id)??!1;optionsElement.prepend(renderEntry(item,isChecked))}commentElement?.removeAttribute("hidden"),onInput()}async function sendLotteryData(date,time){if(!(!date||!time)){useLotteryStore.getState().setDatetime({date,time});try{const credentialsPayload=useCredentialsStore.getState().credentials;useLotteryStore.getState().markAsSent(),tg.sendData(JSON.stringify({payload:{date,time,...credentialsPayload},type:"lottery"}))}catch(error){console.log(error)}}}function showTimeslots(event){const tileGroupElement=document.querySelector(".lottery-tile-group--time"),timeContainers=tileGroupElement.querySelectorAll(".lottery-input-container"),selectedTimeContainer=event.currentTarget;tileGroupElement.classList.remove("hidden");for(const timeContainer of timeContainers){timeContainer.dataset.date=selectedTimeContainer.dataset.date;const timeContainerTimestamp=parseDatetimeAttributes(timeContainer);if(!timeContainerTimestamp)return;const timeInput=timeContainer.querySelector("input");isTimestampPassed(timeContainerTimestamp)?timeInput?.setAttribute("disabled","disabled"):timeInput?.removeAttribute("disabled")}}function parseDatetimeAttributes(element){if(!(!element.dataset.date||!element.dataset.time))return Date.parse(`${element.dataset.date}T${element.dataset.time}`)}function LotteryPage(){function navigateBackToCategories(){renderPage("categories")}const lotteryHasBeenSent=useLotteryStore.getState().hasBeenSent,registerButton=tg.MainButton.setParams({text:lotteryHasBeenSent?" ":" ",color:"#FF9448",text_color:"#ffffff",is_active:!1,is_visible:!1});tg.BackButton.onClick(navigateBackToCategories).show(),registerButton.onClick(async()=>await sendLotteryData(registrationDate,registrationTime));let registrationDate,registrationTime;const dateContainers=document.querySelectorAll(".lottery-tile-group--date .lottery-input-container"),timeContainers=document.querySelectorAll(".lottery-tile-group--time .lottery-input-container");for(const dateContainer of dateContainers){const date=dateContainer.dataset.date;date&&isDatePassed(date)&&dateContainer.querySelector("input")?.setAttribute("disabled","disabled"),dateContainer.addEventListener("click",showTimeslots)}for(const timeContainer of timeContainers)timeContainer.addEventListener("click",event=>{const eventTarget=event.target;registrationDate=eventTarget.parentElement.dataset.date,registrationTime=eventTarget.parentElement.dataset.time,registrationDate&&registrationTime&&registerButton.enable().show()});lotteryHasBeenSent&&(registrationDate=useLotteryStore.getState().date,registrationTime=useLotteryStore.getState().time,[...dateContainers].find(dateContainer=>dateContainer.dataset.date===registrationDate)?.dispatchEvent(new MouseEvent("click")),[...timeContainers].find(timeContainer=>timeContainer.dataset.time===registrationTime)?.dispatchEvent(new MouseEvent("click")))}function handleBack(){renderPage("start")}async function MapPage(){tg.BackButton.onClick(handleBack).show()}async function renderPage(page,category){const pages={start:{pageFn:StartPage,templateId:"start"},categories:{pageFn:CategoriesPage,templateId:"categories"},items:{pageFn:()=>FormPage(category),templateId:"items"},lottery:{pageFn:LotteryPage,templateId:"lottery"},map:{pageFn:MapPage,templateId:"map"}},{pageFn,templateId}=pages[page],app=document.querySelector("#app"),pageTemplate=document.querySelector(`template#${templateId}`);tg.MainButton.hide().disable().offClick(()=>{}),tg.SecondaryButton.hide().disable().offClick(()=>{}),tg.BackButton.offClick(()=>{}).hide(),app.innerHTML="",app.appendChild(pageTemplate.content.cloneNode(!0)),await pageFn()}Promise.all([usePuzzleStore.persist.rehydrate(),useLotteryStore.persist.rehydrate()]).then(async()=>{console.log(useCredentialsStore.getState()),console.log(useLotteryStore.getState()),console.log(usePuzzleStore.getState()),await renderPage("start")});
